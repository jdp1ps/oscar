(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["ActivityDocument"]=t():e["ActivityDocument"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(o,s,function(t){return e[t]}.bind(null,s));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="fb15")}({8875:function(e,t,r){var o,s,n;(function(r,i){s=[],o=i,n="function"===typeof o?o.apply(t,s):o,void 0===n||(e.exports=n)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(f){var r,o,s,n=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,i=/@([^@]*):(\d+):(\d+)\s*$/gi,a=n.exec(f.stack)||i.exec(f.stack),c=a&&a[1]||!1,l=a&&a[2]||!1,u=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");c===u&&(r=document.documentElement.outerHTML,o=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),s=r.replace(o,"$1").trim());for(var p=0;p<d.length;p++){if("interactive"===d[p].readyState)return d[p];if(d[p].src===c)return d[p];if(c===u&&d[p].innerHTML&&d[p].innerHTML.trim()===s)return d[p]}return null}}return e}))},fb15:function(e,t,r){"use strict";if(r.r(t),"undefined"!==typeof window){var o=window.document.currentScript,s=r("8875");o=s(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:s});var n=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(r.p=n[1])}var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[e.deleteData?r("div",{staticClass:"overlay"},[r("div",{staticClass:"overlay-content"},[r("h2",[e._v(" Suppression du fichier ? "),r("span",{staticClass:"overlay-closer",on:{click:function(t){e.deleteData=null}}},[e._v("X")])]),r("p",{staticClass:"alert-danger alert"},[r("i",{staticClass:"icon-attention-1"}),e._v(" Souhaitez-vous supprimer le fichier "),r("strong",[e._v(e._s(e.deleteData.fileName))]),e._v(" ? ")]),r("button",{staticClass:"btn btn-danger",on:{click:function(t){e.deleteData=null}}},[r("i",{staticClass:"icon-cancel-alt"}),e._v(" Annuler ")]),r("a",{staticClass:"btn btn-success",attrs:{href:e.deleteData.urlDelete}},[r("i",{staticClass:"icon-valid"}),e._v(" Confirmer ")])])]):e._e(),r("div",[r("div",{staticClass:"oscar-sorter"},[r("i",{staticClass:" icon-sort"}),e._v(" Tier les résultats par : "),r("a",{staticClass:"oscar-sorter-item",class:e.cssSort("dateUpload"),attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.order("dateUpload")}}},[e._v(" Date d'upload "),r("i",{directives:[{name:"show",rawName:"v-show",value:1==e.sortDirection,expression:"sortDirection == 1"}],staticClass:"icon-angle-down"}),r("i",{directives:[{name:"show",rawName:"v-show",value:-1==e.sortDirection,expression:"sortDirection == -1"}],staticClass:"icon-angle-up"})]),r("a",{staticClass:"oscar-sorter-item",class:e.cssSort("fileName"),attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.order("fileName")}}},[e._v(" Nom du fichier "),r("i",{directives:[{name:"show",rawName:"v-show",value:1==e.sortDirection,expression:"sortDirection == 1"}],staticClass:"icon-angle-down"}),r("i",{directives:[{name:"show",rawName:"v-show",value:-1==e.sortDirection,expression:"sortDirection == -1"}],staticClass:"icon-angle-up"})]),r("a",{staticClass:"oscar-sorter-item",class:e.cssSort("categoryText"),attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.order("categoryText")}}},[e._v(" Type de document "),r("i",{directives:[{name:"show",rawName:"v-show",value:1==e.sortDirection,expression:"sortDirection == 1"}],staticClass:"icon-angle-down"}),r("i",{directives:[{name:"show",rawName:"v-show",value:-1==e.sortDirection,expression:"sortDirection == -1"}],staticClass:"icon-angle-up"})])])]),e._l(e.documentsPacked,(function(t){return r("article",{staticClass:"card xs"},[r("div",{staticClass:"card-title"},[r("i",{staticClass:"picto icon-doc",class:"doc"+t.extension}),t.editmode?[r("select",{on:{change:function(r){return e.changeTypeDocument(t,r)},blur:function(e){t.editmode=!1}}},e._l(e.documentTypes,(function(o,s){return r("option",{domProps:{value:s,selected:t.categoryText==o}},[e._v(e._s(o))])})),0)]:[r("small",{staticClass:"text-light",on:{dblclick:function(e){t.editmode=!0}}},[e._v(e._s(t.categoryText)+" ~ ")])],r("strong",[e._v(e._s(t.fileName))]),r("small",{staticClass:"text-light",attrs:{title:t.fileSize+" octet(s)"}},[e._v(" ("+e._s(e._f("filesize")(t.fileSize))+")")])],2),r("p",[e._v(" "+e._s(t.information)+" ")]),r("div",{staticClass:"card-content"},[r("p",{staticClass:"text-highlight"},[e._v(" Fichier "),r("strong",[e._v(e._s(t.extension))]),e._v(" version "+e._s(t.version)+", téléversé le "),r("time",[e._v(e._s(e._f("dateFull")(t.dateUpload)))]),t.uploader?r("span",[e._v(" par "),r("strong",[e._v(e._s(t.uploader.displayname))])]):e._e()]),t.previous.length?r("div",{staticClass:"exploder",on:{click:function(e){t.explode=!t.explode}}},[e._v(" Versions précédentes "),r("i",{directives:[{name:"show",rawName:"v-show",value:!t.explode,expression:"!document.explode"}],staticClass:"icon-angle-down"}),r("i",{directives:[{name:"show",rawName:"v-show",value:t.explode,expression:"document.explode"}],staticClass:"icon-angle-up"})]):e._e(),t.previous.length?r("div",{directives:[{name:"show",rawName:"v-show",value:t.explode,expression:"document.explode"}]},e._l(t.previous,(function(t){return r("article",{staticClass:"subdoc text-highlight"},[r("i",{staticClass:"picto icon-doc",class:"doc"+t.extension}),r("strong",[e._v(e._s(t.fileName))]),e._v(" version "),r("em",[e._v(e._s(t.version)+" ")]),e._v(", téléchargé le "),r("time",[e._v(e._s(e._f("dateFullSort")(t.dateUpload)))]),t.uploader?r("span",[e._v(" par "),r("strong",[e._v(e._s(t.uploader.displayname))])]):e._e(),r("a",{attrs:{href:t.urlDownload}},[r("i",{staticClass:"icon-download-outline"}),e._v(" Télécharger cette version ")])])})),0):e._e(),r("nav",{staticClass:"text-right show-over"},[t.urlDownload?r("a",{staticClass:"btn btn-default btn-xs",attrs:{href:t.urlDownload}},[r("i",{staticClass:"icon-download-outline"}),e._v(" Télécharger le fichier ")]):e._e(),t.urlReupload?r("a",{staticClass:"btn btn-default btn-xs",attrs:{href:t.urlReupload}},[r("i",{staticClass:"icon-download-outline"}),e._v(" Nouvelle version ")]):e._e(),r("a",{staticClass:"btn btn-default btn-xs",on:{click:function(r){return r.preventDefault(),e.deleteDocument(t)}}},[r("i",{staticClass:"icon-trash"}),e._v(" supprimer le fichier ")])])])])}))],2)},a=[],c={setup(){console.log("Setup")},props:{url:{required:!0},documentTypes:{required:!0},urlDocumentType:{required:!0}},data(){return{formData:null,error:null,deleteData:null,documents:[],loading:!0,sortField:"dateUpload",sortDirection:-1,editable:!0}},computed:{documentsPacked(){var e=this.documents.sort(function(e,t){return e[this.sortField]<t[this.sortField]?-1*this.sortDirection:e[this.sortField]>t[this.sortField]?1*this.sortDirection:0}.bind(this));return e}},methods:{deleteDocument(e){this.deleteData=e},order:function(e){this.sortField==e?this.sortDirection*=-1:this.sortField=e},cssSort:function(e){return e==this.sortField?"active":""},changeTypeDocument:function(e,t){var r=$(t.target.selectedOptions[0]).text();$.post(this.urlDocumentType,{documentId:e.id,type:r}).then(t=>{flashMessage("success","Le document a bien été modifié"),e.categoryText=r,e.editMode=!1,this.$forceUpdate()},t=>{flashMessage("error","Erreur"+t.responseText),e.editMode=!1})},fetch(){this.$http.get(this.url).then(e=>{let t=e.data.datas,r=[],o={};t.forEach((function(e){e.categoryText=e.category?e.category.label:"",e.editmode=!1,e.explode=!1;var t=e.fileName;o[t]?o[t].previous.push(e):(o[t]=e,o[t].previous=[],r.push(e))})),this.documents=r},e=>{console.log("ERROR",e)})}},mounted(){this.fetch()}},l=c;function u(e,t,r,o,s,n,i,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),o&&(l.functional=!0),n&&(l._scopeId="data-v-"+n),i?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},l._ssrRegister=c):s&&(c=a?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}var d=u(l,i,a,!1,null,null,null),p=d.exports;t["default"]=p}})["default"]}));
//# sourceMappingURL=ActivityDocument.umd.min.js.map