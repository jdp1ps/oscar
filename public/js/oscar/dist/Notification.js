(function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.notification=e():t.notification=e()})("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{url:{required:!0},urlHistory:{required:!0}},data:function(){return{open:!1,loading:!0,notifications:[],urlActivityShow:"/activites-de-recherche/fiche-detaillee/"}},computed:{orderedNotifications:function(){return this.notifications.sort(function(t,e){return t.dateEffective>e.dateEffective?-1:t.dateEffective<e.dateEffective?1:0})}},methods:{handlerClickNotification:function(t,e){var n=this,i=null;t.target.href&&(i=t.target.href),console.log(i),this.$http.delete(this.url+"?ids="+e.id).then(function(t){i&&(document.location=i)},function(t){console.log("ERROR")}).then(function(){n.loading=!1})},messageHTML:function(t){var e=/(.*)\[Activity:([0-9]*):(.*)\](.*)/;return e.exec(t)?t.replace(e,'$1<a href="'+this.urlActivityShow+'$2">$3</a> $4'):t},deleteNotification:function(t){var e=this;this.loading=!0;var n=[];t.forEach(function(t){n.push(t.id)}),this.$http.delete(this.url+"?ids="+n.join(",")).then(function(n){console.log("A supprimer",t,"notifications",e.notifications),e.fetch()},function(t){console.log("ERROR")}).then(function(){e.loading=!1})},fetch:function(){var t=this;this.loading=!0,this.$http.get(this.url).then(function(e){t.notifications=e.body.notifications,0==t.notifications.length&&(t.open=!1)},function(t){}).then(function(){return t.loading=!1})}},mounted:function(){this.fetch()}}},function(t,e,n){t.exports=n(2)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);var a=n(4),r=n(3),c=r(o.a,a.a,!1,null,null,null);e.default=c.exports},function(t,e){t.exports=function(t,e,n,i,o,s){var a,r=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(a=t,r=t.default);var f="function"==typeof r?r.options:r;e&&(f.render=e.render,f.staticRenderFns=e.staticRenderFns,f._compiled=!0),n&&(f.functional=!0),o&&(f._scopeId=o);var l;if(s?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},f._ssrRegister=l):i&&(l=i),l){var u=f.functional,d=u?f.render:f.beforeCreate;u?(f._injectStyles=l,f.render=function(t,e){return l.call(e),d(t,e)}):f.beforeCreate=d?[].concat(d,l):[l]}return{esModule:a,exports:r,options:f}}},function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"navbar-text navbar-right",attrs:{id:"notifications-area"}},[n("a",{staticClass:"navbar-link",on:{click:function(e){t.open=!t.open}}},[n("i",{staticClass:"icon-bell"}),t._v(" Notifications\n        "),n("span",{staticClass:"notifications-total",class:t.notifications.length?"unread":""},[t._v(t._s(t.notifications.length))])]),t._v(" "),n("section",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"list"},[n("header",{staticClass:"control"},[n("h3",[n("span",{staticClass:"intitule"},[n("i",{staticClass:"icon-bell"}),t._v("\n                    "+t._s(t.notifications.length)+" notifications\n                    "),n("i",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"animate-spin icon-asterisk"})]),t._v(" "),n("a",{attrs:{href:"#",title:"Tous marquer comme lu"},on:{click:function(e){t.deleteNotification(t.notifications)}}},[n("i",{staticClass:"icon-ok-circled"})])])]),t._v(" "),t._l(t.orderedNotifications,function(e){return n("article",{staticClass:"notification",class:{read:e.read,fresh:e.fresh}},[n("h4",[n("i",{class:"icon-"+e.context}),t._v("\n                réçue le\n                "),n("time",{attrs:{datetime:""}},[t._v(t._s(t._f("displayDate")(e.dateEffective)))]),t._v(" "),n("a",{attrs:{href:"#"},on:{click:function(n){t.deleteNotification([e])}}},[n("i",{staticClass:"icon-trash-empty"})])]),t._v(" "),n("p",[n("span",{domProps:{innerHTML:t._s(t.messageHTML(e.message))},on:{click:function(n){n.preventDefault(),n.stopPropagation(),t.handlerClickNotification(n,e)}}}),t._v(" le "+t._s(t._f("displayDate")(e.dateReal)))])])}),t._v(" "),n("footer",{staticClass:"control"},[n("a",{attrs:{href:t.urlHistory}},[t._v("Historique des notifications")])])],2)])},o=[],s={render:i,staticRenderFns:o};e.a=s}])});
//# sourceMappingURL=Notification.js.map