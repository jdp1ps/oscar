(function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ActivitySpentSynthesis=e():t.ActivitySpentSynthesis=e()})("undefined"!=typeof self?self:this,function(){return function(t){function e(s){if(n[s])return n[s].exports;var a=n[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,s){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=1)}([function(t,e,n){"use strict";e.a={props:["url","manageDepense"],data:function(){return{error:null,warning:null,pendingMsg:"",synthesis:[],masses:{},dateUpdated:null,showCuration:!1,affectations:{}}},computed:{getNoMasse:function(){var t=[];for(var e in this.synthesis.details["N.B"]){var n=this.synthesis.details["N.B"][e];t.indexOf(n)<0&&t.push(n)}return t}},methods:{handlerCuration:function(){if(this.synthesis.curations)for(var t in this.synthesis.curations)this.affectations.hasOwnProperty(t)||(this.affectations[t]="");this.showCuration=!0},updateAffectations:function(t,e){console.log(t,e.target.value),this.affectations[t]=e.target.value,console.log(this.affectations)},handlerCurationCancel:function(){this.showCuration=!1},handlerCurationConfirm:function(){var t=this;this.pendingMsg="Enregistrement",this.$http.post(this.url,{affectation:this.affectations}).then(function(e){t.fetch(),t.showCuration=!1},function(e){403==e.status?t.error="Vous n'avez pas l'autorisation d'accès à ces informations.":t.error="Impossible de charger les dépenses pour ce PFI : "+e.data}).then(function(e){t.pendingMsg=""})},fetch:function(){var t=this;this.pendingMsg="Chargement des donnèes",this.$http.get(this.url).then(function(e){t.synthesis=e.data.synthesis,t.masses=e.data.masses,t.dateUpdated=e.data.dateUpdated,t.error=e.data.error,t.warning=e.data.warning},function(e){403==e.status?t.error="Vous n'avez pas l'autorisation d'accès à ces informations.":t.error="Impossible de charger les dépenses pour ce PFI : "+e.data}).then(function(e){t.pendingMsg=""})}},mounted:function(){this.fetch()}}},function(t,e,n){t.exports=n(2)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),a=n(4),i=n(3),r=i(s.a,a.a,!1,null,null,null);e.default=r.exports},function(t,e){t.exports=function(t,e,n,s,a,i){var r,o=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(r=t,o=t.default);var l="function"==typeof o?o.options:o;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0),n&&(l.functional=!0),a&&(l._scopeId=a);var u;if(i?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=u):s&&(u=s),u){var d=l.functional,f=d?l.render:l.beforeCreate;d?(l._injectStyles=u,l.render=function(t,e){return u.call(e),f(t,e)}):l.beforeCreate=f?[].concat(f,u):[u]}return{esModule:r,exports:o,options:l}}},function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("transition",{attrs:{name:"fade"}},[t.showCuration?n("div",{staticClass:"overlay"},[n("div",{staticClass:"overlay-content"},[n("h3",[t._v("\n                    Qualification des comptes\n                    "),n("span",{staticClass:"overlay-closer",on:{click:function(e){t.showCuration=!1}}},[t._v("X")])]),t._v(" "),n("p",[t._v("Les comptes suivants ne sont pas qualifiés, vous pouvez utiliser cet écran pour les attribuer à une masse budgétaire :")]),t._v(" "),t._l(t.synthesis.curations,function(e){return n("div",{staticClass:"card row"},[n("div",{staticClass:"col-md-4"},[n("strong",[t._v(t._s(e.compte))]),t._v(" - "),n("em",[t._v(t._s(e.compteInfos.label))])]),t._v(" "),n("div",{staticClass:"col-md-8"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.affectations[e.compte],expression:"affectations[c.compte]"}],staticClass:"form-control",attrs:{name:"",id:""},on:{change:[function(n){var s=Array.prototype.filter.call(n.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.affectations,e.compte,n.target.multiple?s:s[0])},function(n){return t.updateAffectations(e.compte,n)}]}},[n("option",{attrs:{value:"0"}},[t._v("Ignorer")]),t._v(" "),n("option",{attrs:{value:"1"}},[t._v("Traiter comme une recette")]),t._v(" "),t._l(t.masses,function(e,s){return n("option",{domProps:{value:s}},[t._v(t._s(e))])})],2)])])}),t._v(" "),n("hr"),t._v(" "),n("button",{staticClass:"btn btn-danger",on:{click:t.handlerCurationCancel}},[n("i",{staticClass:"icon-cancel-circled"}),t._v("Annuler")]),t._v(" "),n("button",{staticClass:"btn btn-success",on:{click:t.handlerCurationConfirm}},[n("i",{staticClass:"icon-floppy"}),t._v("Enregistrer")])],2)]):t._e()]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.error?n("div",{staticClass:"alert alert-danger"},[n("i",{staticClass:"icon-attention-1"}),t._v("\n            Il y'a eut un problème lors de la récupération des données financières :\n            "+t._s(t.error)+"\n        ")]):t._e()]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.warning?n("div",{staticClass:"alert-warning alert"},[n("i",{staticClass:"icon-warning-empty"}),t._v("\n            Les données affichées peuvent ne pas être à jour :\n            "+t._s(t.warning)+"\n        ")]):t._e()]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.pendingMsg?n("div",{staticClass:"pending"},[n("div",{},[n("i",{staticClass:"icon-spinner animate-spin"}),t._v("\n                "+t._s(t.pendingMsg)+"\n            ")])]):t._e()]),t._v(" "),t.pendingMsg?t._e():n("table",{staticClass:"table table-condensed"},[t._l(t.masses,function(e,s){return n("tr",[n("th",[t._v(t._s(e))]),t._v(" "),n("td",{staticStyle:{"text-align":"right","white-space":"nowrap"}},[t._v(t._s(t._f("money")(t.synthesis[s]))+" €")])])}),t._v(" "),t.synthesis["N.B"]?n("tr",{staticStyle:{"border-top":"solid #000 thin"}},[n("th",[t._v("\n                Hors masse"),n("br"),t._v(" "),n("small",{staticClass:"error-block",staticStyle:{"font-weight":"300"}},[n("i",{staticClass:"icon-attention"}),t._v(" Les annexes de certains comptes ne sont pas renseignés :\n                    "),n("ul",t._l(t.getNoMasse,function(e){return n("li",[n("strong",[t._v(t._s(e))]),t._v(" "),t.synthesis.curations?n("div"):t._e()])}),0),t._v(" "),t.manageDepense?n("a",{staticClass:"btn btn-xs btn-default",on:{click:t.handlerCuration}},[n("i",{staticClass:"icon-cog"}),t._v("Qualifer les comptes")]):n("span",[t._v("Merci de contacter un administrateur pour que les annexes des comptes soient configurés.")])])]),t._v(" "),n("td",{staticStyle:{"text-align":"right","white-space":"nowrap"}},[t._v(t._s(t._f("money")(t.synthesis["N.B"]))+" €")])]):t._e(),t._v(" "),n("tr",{staticStyle:{"border-top":"solid #000 thin","font-size":"1.6em"}},[n("th",[t._v("TOTAL : ")]),t._v(" "),n("td",{staticStyle:{"text-align":"right","white-space":"nowrap"}},[t._v(t._s(t._f("money")(t.synthesis.total))+" €")])])],2),t._v(" "),t.synthesis.recettes?n("table",{staticClass:"table table-condensed"},[n("tr",[t._m(0),t._v(" "),n("td",{staticStyle:{"text-align":"right","white-space":"nowrap"}},[t._v(t._s(t._f("money")(t.synthesis.recettes.total))+" €")])])]):t._e(),t._v(" "),n("small",[t._v("Données mise à jour : "),t.dateUpdated?n("strong",[t._v(t._s(t._f("dateFull")(t.dateUpdated.date)))]):t._e()])],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",[n("i",{staticClass:"icon-euro"}),t._v("Recettes")])}],i={render:s,staticRenderFns:a};e.a=i}])});
//# sourceMappingURL=ActivitySpentSynthesis.js.map