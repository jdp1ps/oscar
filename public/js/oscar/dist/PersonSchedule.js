(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PersonSchedule=t():e.PersonSchedule=t()})("undefined"!=typeof self?self:this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),s=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={name:"PersonSchedule",props:{urlapi:{default:""},editable:{default:!1},schedule:null},data:function(){return{daysLabels:{1:"Lundi",2:"Mardi",3:"Mercredi",4:"Jeudi",5:"Vendredi",6:"Samedi",7:"Dimanche"},loading:null,error:null,dayLength:0,from:null,days:{},editDay:null,newValue:0,models:[],model:null}},computed:{totalWeek:function(){var e=this,t=0;return Object.keys(this.days).forEach(function(n){t+=parseFloat(e.days[n])}),t}},methods:{day:function(e){return this.days.hasOwnProperty(e)?this.days[e]:this.dayLength},handlerEditDays:function(){this.editDay=!0},handlerCancel:function(){this.urlapi?this.fetch():this.$emit("cancel")},handlerSaveDays:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"input";if(this.urlapi){this.loading="Enregistrement des horaires";var n=new FormData;"input"==t?n.append("days",JSON.stringify(this.days)):n.append("model",t),this.$http.post(this.urlapi,n).then(function(t){e.fetch()},function(t){e.error=s.default.resolve("Impossible de modifier les horaires",t)}).then(function(t){e.loading=!1})}else this.$emit("changeschedule",this.days)},fetch:function(){var e=this;!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null==this.schedule?(this.loading="Chargement des données",this.$http.get(this.urlapi).then(function(t){console.log(t.body),e.days=t.body.days,e.dayLength=t.body.dayLength,e.from=t.body.from,e.models=t.body.models,e.model=t.body.model},function(t){e.error=s.default.resolve("Impossible de charger les données",t)}).then(function(t){e.loading=!1,e.editDay=null})):(console.log(this.schedule),this.days=this.schedule.days,this.dayLength=this.schedule.dayLength,this.editDay=!0)}},mounted:function(){this.fetch(!0)}}},function(e,t,n){e.exports=n(2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);var o=n(5),r=n(3),l=r(s.a,o.a,!1,null,null,null);t.default=l.exports},function(e,t){e.exports=function(e,t,n,a,s,i){var o,r=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(o=e,r=e.default);var d="function"==typeof r?r.options:r;t&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0),n&&(d.functional=!0),s&&(d._scopeId=s);var c;if(i?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},d._ssrRegister=c):a&&(c=a),c){var u=d.functional,f=u?d.render:d.beforeCreate;u?(d._injectStyles=c,d.render=function(e,t){return c.call(t),f(e,t)}):d.beforeCreate=f?[].concat(f,c):[c]}return{esModule:o,exports:r,options:d}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={resolve:function(e,t){var n="Erreur inconnue";return t&&(n=t.body,403==t.status&&(n="Vous avez été déconnectez de l'application")),e+" (Réponse : "+n+")"}}},function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"schedule"},[n("transition",{attrs:{name:"fade"}},[e.loading?n("div",{staticClass:"pending overlay"},[n("div",{staticClass:"overlay-content"},[n("i",{staticClass:"icon-spinner animate-spin"}),e._v("\n                "+e._s(e.loading)+"\n            ")])]):e._e()]),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.error?n("div",{staticClass:"pending overlay"},[n("div",{staticClass:"overlay-content"},[n("i",{staticClass:"icon-attention-1"}),e._v("\n                "+e._s(e.error)+"\n            ")])]):e._e()]),e._v(" "),n("p",[e._v("La répartition horaire est issue de "+e._s(e.from)+"\n\n    "),"application"==e.from?n("strong",[e._v("la configuration Oscar par défaut")]):e._e(),e._v(" "),"sync"==e.from?n("strong",[e._v("la synchronisation (Connector)")]):e._e(),e._v(" "),"custom"==e.from?n("strong",[e._v("la configuration prédéfinie")]):e._e(),e._v(" "),"free"==e.from?n("strong",[e._v("la configuration manuelle")]):e._e()]),e._v(" "),e._l(e.days,function(t,a){return n("article",{staticClass:"card xs"},[n("h3",{staticClass:"card-title"},[n("strong",[e._v(e._s(e.daysLabels[a]))]),e._v(" "),e.editDay?n("input",{directives:[{name:"model",rawName:"v-model",value:e.days[a],expression:"days[day]"}],attrs:{type:"text"},domProps:{value:e.days[a]},on:{input:function(t){t.target.composing||e.$set(e.days,a,t.target.value)}}}):n("em",{staticClass:"big right",on:{click:function(t){e.handlerEditDays()}}},[e._v(e._s(e._f("heures")(t)))])])])}),e._v(" "),n("article",{staticClass:"card"},[n("h3",{staticClass:"card-title"},[n("strong",[e._v("Total / semaine")]),e._v(" "),n("em",{staticClass:"big right"},[e._v(e._s(e._f("heures")(e.totalWeek)))])])]),e._v(" "),e.editable?n("nav",[e.editDay?e._e():n("button",{staticClass:"btn btn-default",on:{click:function(t){t.preventDefault(),e.handlerEditDays()}}},[n("i",{staticClass:"icon-pencil"}),e._v(" modifier")]),e._v(" "),e.editDay?n("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.handlerSaveDays()}}},[n("i",{staticClass:"icon-floppy"}),e._v(" enregistrer")]):e._e(),e._v(" "),e.models&&e.editDay?n("select",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],staticClass:"form-inline",on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.model=t.target.multiple?n:n[0]},function(t){e.handlerSaveDays(e.model)}]}},[n("option",{attrs:{value:"default"}},[e._v("Aucun")]),e._v(" "),e._l(e.models,function(t,a){return n("option",{domProps:{value:a,selected:e.model==a}},[e._v(e._s(t.label))])})],2):e._e(),e._v(" "),e.editDay&&"default"!=e.from?n("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.handlerSaveDays("default")}}},[n("i",{staticClass:"icon-floppy"}),e._v(" Horaires par défaut")]):e._e(),e._v(" "),e.editDay?n("button",{staticClass:"btn btn-primary",on:{click:function(t){t.preventDefault(),e.handlerCancel()}}},[n("i",{staticClass:"icon-cancel-circled"}),e._v(" annuler")]):e._e()]):e._e()],2)},s=[],i={render:a,staticRenderFns:s};t.a=i}])});
//# sourceMappingURL=PersonSchedule.js.map