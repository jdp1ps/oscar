(function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ActivityRequestAdmin=e():t.ActivityRequestAdmin=e()})("undefined"!=typeof self?self:this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{formData:null,addFile:!1,addableFiles:null,file:null,loading:"",activityRequests:[],error:null,deleteData:null,allowNew:!1,demandeur:"",demandeur_id:null,organisations:[],lockMessages:[]}},props:{moment:{required:!0}},computed:{},methods:{processFile:function(t){this.addableFiles=t.target.files[0].name},handlerAddFile:function(){this.addFile=!0},fetch:function(){var t=this;this.loading="Chargement des Demandes",this.$http.get("?").then(function(e){t.activityRequests=e.body.activityRequests,t.allowNew=e.body.allowNew,t.demandeur=e.body.demandeur,t.demandeur_id=e.body.demandeur_id,t.organisations=e.body.organisations,t.lockMessages=e.body.lockMessages},function(e){t.error="Impossible de charger les demandes : "+e.body}).then(function(e){t.loading=null})},sendFile:function(t,e){var n=new FormData(e.target);this.$http.post("?",n).then(function(t){}).catch(function(t){})},handlerSend:function(t){var e=this,n=new FormData;n.append("action","send"),n.append("id",t.id),this.$http.post("?",n).then(function(t){e.fetch()}).catch(function(t){e.error=t.body})},handlerNew:function(){this.formData={id:null,label:"",description:"",dateStart:null,dateEnd:null,amount:0,organization:this.organisations[0],files:[]}},handlerEdit:function(t){this.formData={id:t.id,label:t.label,description:t.description,dateStart:t.dateStart,dateEnd:t.dateEnd,amount:t.amount,organization:t.organization,files:t.files}},handlerDeleteFile:function(t,e){var n=this;this.loading="Suppression du fichier "+t.name,this.$http.get("?rdl="+t.file+"&id="+e.id).then(function(t){n.fetch()}).catch(function(t){n.error=t.body}).finally(function(t){n.loading=""})},handlerSave:function(t){var e=this,n=new FormData(t.target);n.append("dateStart",this.formData.dateStart),n.append("dateEnd",this.formData.dateEnd),this.$http.post("?",n).then(function(t){e.fetch(),e.formData=null}).catch(function(t){e.error=t.body,e.formData=null,console.log(t)})},handlerCancelForm:function(){this.formData=null},handlerDelete:function(t){this.deleteData=t},performDelete:function(){var t=this;this.loading="Suppression de la demande "+this.deleteData.label;var e=this.deleteData;this.$http.delete("?id="+e.id).then(function(e){t.fetch()},function(e){t.error=e.body}).then(function(e){return t.deleteData=null})}},mounted:function(){this.fetch()}}},function(t,e,n){t.exports=n(2)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var o=n(4),s=n(3),l=s(i.a,o.a,!1,null,null,null);e.default=l.exports},function(t,e){t.exports=function(t,e,n,a,i,r){var o,s=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(o=t,s=t.default);var d="function"==typeof s?s.options:s;e&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0),n&&(d.functional=!0),i&&(d._scopeId=i);var c;if(r?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=c):a&&(c=a),c){var u=d.functional,f=u?d.render:d.beforeCreate;u?(d._injectStyles=c,d.render=function(t,e){return c.call(e),f(t,e)}):d.beforeCreate=f?[].concat(f,c):[c]}return{esModule:o,exports:s,options:d}}},function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"alert alert-info"},[t._v(t._s(t.loading))]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.error?n("div",{staticClass:"overlay"},[n("div",{staticClass:"alert alert-danger"},[n("h3",[t._v("Erreur\n                    "),n("a",{staticClass:"float-right",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.error=null}}},[n("i",{staticClass:"icon-cancel-outline"})])]),t._v(" "),n("p",[t._v(t._s(t.error))])])]):t._e()]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.deleteData?n("div",{staticClass:"overlay"},[n("div",{staticClass:"alert alert-danger"},[n("h3",[t._v("Supprimer la demande "),n("strong",[t._v(t._s(t.deleteData.label))]),t._v(" ?")]),t._v(" "),n("nav",[n("button",{staticClass:"btn btn-danger",attrs:{type:"reset"},on:{click:function(e){e.preventDefault(),t.deleteData=null}}},[n("i",{staticClass:"icon-cancel-outline"}),t._v("\n                        Annuler\n                    ")]),t._v(" "),n("button",{staticClass:"btn btn-success",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.performDelete(e)}}},[n("i",{staticClass:"icon-ok-circled"}),t._v("\n                        Confirmer\n                    ")])])])]):t._e()]),t._v(" "),n("h1",[t._v("Demandes d'activité en attente")]),t._v(" "),t.activityRequests.length?n("section",t._l(t.activityRequests,function(e){return n("article",{staticClass:"card"},[n("h3",{staticClass:"card-title"},[n("strong",[n("i",{staticClass:"icon-cube"}),t._v("\n                "+t._s(e.label))]),t._v(" "),n("strong",[n("i",{staticClass:"icon-bank"}),t._v("\n                "+t._s(e.amount)+"\n            ")]),t._v(" "),n("small",{staticClass:"right"},[t._v("par "),n("strong",[t._v(t._s(e.requester))])])]),t._v(" "),n("div",{staticClass:"content"},[t._v("\n            Demandeur : "),n("strong",[n("i",{staticClass:"icon-user"}),t._v(" "+t._s(e.requester))]),n("br"),t._v("\n            Organisme : "),e.organisation?n("strong",[n("i",{staticClass:"icon-building-filled"}),t._v(" "+t._s(e.organisation))]):n("em",[t._v("Aucun organisme identifié")])]),t._v(" "),n("pre",[t._v(t._s(e))])])})):n("div",[n("p",{staticClass:"alert alert-info"},[t._v("\n            Aucune demande\n        ")])])],1)},i=[],r={render:a,staticRenderFns:i};e.a=r}])});
//# sourceMappingURL=ActivityRequestAdmin.js.map