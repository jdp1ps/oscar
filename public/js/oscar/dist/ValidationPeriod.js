(function(t,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?exports.ValidationPeriod=a():t.ValidationPeriod=a()})("undefined"!=typeof self?self:this,function(){return function(t){function a(n){if(s[n])return s[n].exports;var e=s[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}var s={};return a.m=t,a.c=s,a.d=function(t,s,n){a.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:n})},a.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(s,"a",s),s},a.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},a.p="/",a(a.s=1)}([function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={valid:"Validée","send-prj":"Validation projet","send-sci":"Validation scientifique","send-adm":"Validation administrative",conflict:"Refusée"};a.default={filters:{status:function(t){return n[t]}},data:function(){return{error:null,declarations:null,group:"monthLabel"}},props:{bootbox:{required:!0}},computed:{periodsPerson:function(){return this.declarations}},methods:{fetch:function(){var t=this;this.$http.get().then(function(a){var s=[];Object.keys(a.body).forEach(function(t){a.body[t].open=a.body[t].validableStep,s.push(a.body[t])}),t.declarations=s},function(a){t.error="Impossible de charger les données : "+a.body})},validate:function(t){var a=this;this.bootbox.confirm("Valider cette déclaration ?",function(s){s&&a.send("valid",t,"")})},reject:function(t){var a=this;this.bootbox.prompt("Refuser cette déclaration ?",function(s){s&&a.send("reject",t,s)})},send:function(t,a,s){var n=this,e=new FormData;e.append("period_id",a),e.append("action",t),e.append("message",s),this.$http.post("",e).then(function(t){n.fetch()},function(t){n.error="Erreur : "+t.body})}},mounted:function(){this.fetch()}}},function(t,a,s){t.exports=s(2)},function(t,a,s){"use strict";function n(t){s(3)}Object.defineProperty(a,"__esModule",{value:!0});var e=s(0),i=s.n(e);for(var o in e)"default"!==o&&function(t){s.d(a,t,function(){return e[t]})}(o);var r=s(5),l=s(4),c=n,d=l(i.a,r.a,!1,c,null,null);a.default=d.exports},function(t,a){},function(t,a){t.exports=function(t,a,s,n,e,i){var o,r=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(o=t,r=t.default);var c="function"==typeof r?r.options:r;a&&(c.render=a.render,c.staticRenderFns=a.staticRenderFns,c._compiled=!0),s&&(c.functional=!0),e&&(c._scopeId=e);var d;if(i?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=d):n&&(d=n),d){var _=c.functional,u=_?c.render:c.beforeCreate;_?(c._injectStyles=d,c.render=function(t,a){return d.call(a),u(t,a)}):c.beforeCreate=u?[].concat(u,d):[d]}return{esModule:o,exports:r,options:c}}},function(t,a,s){"use strict";var n=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[t.error?s("div",{staticClass:"overlay",staticStyle:{"z-index":"2002"}},[s("div",{staticClass:"content container overlay-content"},[t._m(0),t._v(" "),s("pre",{staticClass:"alert alert-danger"},[t._v(t._s(t.error))]),t._v(" "),s("p",{staticClass:"text-danger"},[t._v("\n                Si ce message ne vous aide pas, transmettez le à l'administrateur Oscar.\n            ")]),t._v(" "),s("nav",{staticClass:"buttons"},[s("button",{staticClass:"btn btn-primary",on:{click:function(a){t.error=""}}},[t._v("Fermer")])])])]):t._e(),t._v(" "),t.declarations&&t.declarations.length?s("section",{staticClass:"validation"},t._l(t.periodsPerson,function(a){return s("section",[s("h3",{class:{"has-validation":a.validableStep},on:{click:function(t){a.open=!a.open}}},[s("strong",{staticClass:"person"},[s("i",{staticClass:"icon-user"}),t._v(" "+t._s(a.person))]),t._v(" "),s("strong",{staticClass:"period"},[s("i",{staticClass:"icon-calendar"}),t._v(" "+t._s(t._f("period")(a.period)))]),t._v(" "),a.validableStep?s("small",[s("i",{staticClass:"icon-clock"}),t._v("\n                    Validation à faire\n                ")]):t._e()]),t._v(" "),s("transition",{attrs:{name:"slide"}},[s("section",{directives:[{name:"show",rawName:"v-show",value:a.open,expression:"period.open"}],staticClass:"activity card"},[s("table",{staticClass:"table table-condensed"},[s("thead",{staticClass:"heading-days"},[s("th",[t._v("~")]),t._v(" "),t._l(a.details,function(a,n){return s("th",{class:{locked:a.locked}},[s("small",[t._v(t._s(a.label))]),t._v(" "),s("strong",[t._v(t._s(n))])])}),t._v(" "),s("th",[t._v("Total")]),t._v(" "),s("th",{staticStyle:{width:"150px"}},[s("i",{staticClass:"icon-cog"}),t._v(" Validation")])],2),t._v(" "),s("tbody",[t._l(a.declarations_activities,function(n){return[s("tr",{staticClass:"heading-activity heading"},[s("th",{attrs:{colspan:a.totalDays+3}},[s("i",{staticClass:"icon-cube"}),t._v(t._s(n.label)+"\n\n                                "),s("span",{staticClass:"state",class:"state-"+n.status},[s("i",{class:"icon-"+n.status}),t._v("\n                                    "+t._s(t._f("status")(n.status))+"\n                                ")]),t._v(" "),n.validators.length?s("span",[t._v("\n                                    Validateurs :\n                                    "),t._l(n.validators,function(a){return s("span",{staticClass:"cartouche cartouche-xs xs"},[t._v("\n                                        "+t._s(a)+"\n                                    ")])})],2):t._e()])]),t._v(" "),t._l(n.workpackages,function(n){return s("tr",{staticClass:"datas"},[s("th",{attrs:{title:n.label}},[s("i",{staticClass:"icon-archive"}),t._v(t._s(n.code))]),t._v(" "),t._l(a.totalDays,function(a){return s("td",[n.timesheets[a]?s("strong",[t._v(t._s(t._f("duration2")(n.timesheets[a])))]):s("em",[t._v("-")])])}),t._v(" "),s("th",{staticClass:"total"},[t._v("\n                                "+t._s(t._f("duration2")(n.total))+"\n                            ")]),t._v(" "),s("th",[t._v("-")])],2)}),t._v(" "),s("tr",[s("th",{staticStyle:{"padding-left":"1em"},attrs:{colspan:a.totalDays-1}},[t._v("\n                                    Total\n                                ")]),t._v(" "),s("th",{attrs:{colspan:"2"}},[t._v(" ")]),t._v(" "),s("th",{staticClass:"total"},[t._v("\n                                    "+t._s(t._f("duration2")(n.total))+"\n                                ")]),t._v(" "),s("th",[s("small",[s("i",{class:"icon-"+n.status}),t._v(" "+t._s(n.statusMessage))]),t._v(" "),n.validableStep?s("span",[n.validableStep?s("button",{staticClass:"btn btn-success btn-xs",on:{click:function(a){t.validate(n.validationperiod_id)}}},[t._v("Valider")]):t._e(),t._v(" "),n.validableStep?s("button",{staticClass:"btn btn-danger btn-xs",on:{click:function(a){t.reject(n.validationperiod_id)}}},[t._v("Rejeter")]):t._e()]):s("span",[n.validable?s("span",[0==n.validators.length?s("span",{staticClass:"text-danger"},[s("i",{staticClass:"icon-attention-1"}),t._v(" Aucun validateur\n                                            ")]):s("div",t._l(n.validators,function(a){return s("span",{staticClass:"cartouche xs"},[t._v(t._s(a))])}))]):t._e()])])])]}),t._v(" "),a.declarations_others&&0!=a.declarations_others.length?[s("tr",{staticClass:"heading-activity heading"},[s("th",{attrs:{colspan:a.totalDays+3}},[s("i",{staticClass:"icon-tags"}),t._v("Hors-lot")])]),t._v(" "),t._l(a.declarations_others,function(n,e){return s("tr",{staticClass:"datas"},[s("th",[s("i",{staticClass:"hors-lot",class:"icon-"+e}),t._v(t._s(n.label)+"\n                                    "),s("span",{staticClass:"state",class:"state-"+n.status},[s("i",{class:"icon-"+n.status}),t._v("\n                                    "+t._s(t._f("status")(n.status))+"\n                                ")])]),t._v(" "),t._l(a.totalDays,function(a){return s("td",[n.timesheets[a]?s("strong",[t._v(t._s(t._f("duration2")(n.timesheets[a])))]):s("em",[t._v("-")])])}),t._v(" "),s("th",{staticClass:"total"},[t._v("\n                                    "+t._s(t._f("duration2")(n.total))+"\n                                ")]),t._v(" "),s("th",[s("small",[s("i",{class:"icon-"+n.status}),t._v(" "+t._s(n.statusMessage))]),t._v(" "),n.validableStep?s("span",[s("button",{staticClass:"btn btn-success btn-xs",on:{click:function(a){t.validate(n.validationperiod_id)}}},[t._v("Valider")]),t._v(" "),s("button",{staticClass:"btn btn-danger btn-xs",on:{click:function(a){t.reject(n.validationperiod_id)}}},[t._v("Rejeter")])]):n.validabe?s("span",[0==n.validators.length?s("span",[s("i",{staticClass:"icon-attention-1"}),t._v(" Aucun validateur\n                                        ")]):s("div",t._l(n.validators,function(a){return s("span",{staticClass:"cartouche xs"},[t._v(t._s(a))])}))]):t._e()])],2)})]:t._e(),t._v(" "),a.declarations_off&&a.declarations_off.total>0?[s("tr",{staticClass:"heading-activity heading"},[s("th",{attrs:{colspan:a.totalDays+2}},[s("i",{staticClass:"icon-lock"}),t._v("Autres déclarations\n                                ")])]),t._v(" "),s("tr",{staticClass:"datas"},[s("th",[s("small",[t._v("Vous ne pouvez pas voir le détails pour ces créneaux")])]),t._v(" "),t._l(a.totalDays,function(n){return s("td",[a.declarations_off.timesheets[n]?s("strong",[t._v(t._s(t._f("duration2")(a.declarations_off.timesheets[n])))]):s("em",[t._v("-")])])}),t._v(" "),s("th",{staticClass:"total"},[t._v("\n                                    "+t._s(t._f("duration2")(a.declarations_off.total))+"\n                                ")]),t._v(" "),s("td",[t._v("~")])],2)]:t._e()],2),t._v(" "),s("tfoot",[s("tr",{staticClass:"total-row"},[s("th",[t._v("Total période")]),t._v(" "),t._l(a.details,function(a,n){return s("td",{staticClass:"day",class:{locked:a.locked,less:a&&a.duration<a.dayLength,many:a&&a.duration>a.dayLength,warnmin:a&&a.duration<a.amplitudemin,littlemin:a&&a.duration>a.amplitudemin&&a.duration<a.dayLength,warnmax:a&&a.duration>a.amplitudemax,littlemax:a&&a.duration<a.amplitudemax&&a.duration>a.dayLength,exact:a&&a.duration==a.dayLength}},[s("i",{staticClass:"icon-up-outline icon-many"}),t._v(" "),s("i",{staticClass:"icon-down-outline icon-less"}),t._v(" "),s("i",{staticClass:"icon-clock icon-exact"}),t._v(" "),a.duration?s("strong",[t._v(t._s(t._f("duration2")(a.duration)))]):s("small",[t._v("0.0")])])}),t._v(" "),s("th",{staticClass:"total"},[t._v(t._s(t._f("duration2")(a.total)))]),t._v(" "),s("td",[t._v("-")])],2),t._v(" "),s("tr",{staticClass:"total-row"},[s("th",[t._v("Temps normal prévu")]),t._v(" "),t._l(a.details,function(a,n){return s("td",{staticClass:"day"},[s("small",[t._v(t._s(t._f("duration2")(a.dayLength)))])])}),t._v(" "),s("th",{staticClass:"total"},[s("small",[t._v(t._s(t._f("duration2")(a.periodLength)))])]),t._v(" "),s("td",[t._v("-")])],2)])])])])],1)})):s("section",{staticClass:"alert alert-info"},[t._v("\n        Aucune déclaration en attente\n    ")])])},e=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("h2",[s("i",{staticClass:"icon-attention-1"}),t._v(" Oups !")])}],i={render:n,staticRenderFns:e};a.a=i}])});
//# sourceMappingURL=ValidationPeriod.js.map