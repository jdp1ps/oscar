(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.listview=t():e.listview=t()})("undefined"!=typeof self?self:this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=3)}([function(e,t){e.exports=function(e,t,n,i,s,a){var r,c=e=e||{},o=typeof e.default;"object"!==o&&"function"!==o||(r=e,c=e.default);var l="function"==typeof c?c.options:c;t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0),n&&(l.functional=!0),s&&(l._scopeId=s);var v;if(a?(v=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},l._ssrRegister=v):i&&(v=i),v){var d=l.functional,u=d?l.render:l.beforeCreate;d?(l._injectStyles=v,l.render=function(e,t){return v.call(t),u(e,t)}):l.beforeCreate=u?[].concat(u,v):[v]}return{esModule:r,exports:c,options:l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({data:function(){return{}},computed:{firstDate:function(){return this.store.firstEvent},lastDate:function(){return this.store.lastEvent},open:function(){return this.store.listEventsOpen}},props:{withOwner:{},moment:{require:!0},store:{require:!0}},components:{listitem:s.default},methods:{toggle:function(e){-1==this.store.listEventsOpen.indexOf(e)?this.store.listEventsOpen.push(e):this.store.listEventsOpen.splice(this.store.listEventsOpen.indexOf(e),1)},selectEvent:function(e){this.store.currentDay=moment(e.start),this.store.state="week"},getMonthPack:function(e){var t=[];for(var n in e.weeks)e.weeks.hasOwnProperty(n)&&(t=t.concat(this.getWeekPack(e.weeks[n])));return t},getWeekPack:function(e){var t=[];for(var n in e.days)e.days.hasOwnProperty(n)&&(t=t.concat(this.getDayPack(e.days[n])));return t},getDayPack:function(e){return e.events},performYear:function(e,t){var n=[];for(var i in e.months)e.months.hasOwnProperty(i)&&(n=n.concat(this.getMonthPack(e.months[i])));this.performEmit(n,t)},performMonth:function(e,t){this.performEmit(this.getMonthPack(e),t)},performWeek:function(e,t){this.performEmit(this.getWeekPack(e),t)},performDay:function(e,t){this.performEmit(this.getDayPack(e),t)},performEmit:function(e,t){"validatesci"==t?this.$emit("validateevent",e,"sci"):"validateadm"==t?this.$emit("validateevent",e,"adm"):"rejectsci"==t?this.$emit("rejectevent",e,"sci"):"rejectadm"==t?this.$emit("rejectevent",e,"adm"):"submit"==t&&this.$emit("submitevent",e)}}},"computed",{listEvents:function(){if(!this.store.listEvents)return null;for(var e={},t=[],n=this.store.listEvents,i=0;i<n.length;i++){var s=n[i];if((""==this.store.filterActivity||this.store.filterActivity==s.activityId)&&!(""!=this.store.filterOwner&&this.store.filterOwner!=s.owner_id||""!=this.store.filterType&&this.store.filterType!=s.status)){var a=void 0,r=void 0,c=void 0,o=void 0,l=s.duration,v=s.mmStart.format("YYYY"),d=s.mmStart.format("MMMM"),u=s.mmStart.format("W"),f=s.mmStart.format("ddd D");t.indexOf(s.owner_id)<0&&t.push(s.owner_id),e[v]||(e[v]={total:0,months:{},credentials:{send:!1,sci:!1,adm:!1,actions:!1}}),a=e[v],a.total+=l,a.months[d]||(a.months[d]={total:0,weeks:{},credentials:{send:!1,sci:!1,adm:!1,actions:!1}}),r=a.months[d],r.total+=l,r.weeks[u]||(r.weeks[u]={total:0,days:{},credentials:{send:!1,sci:!1,adm:!1,actions:!1}}),c=r.weeks[u],c.total+=l,c.days[f]||(c.days[f]={total:0,persons:[],events:[],credentials:{send:!1,sci:!1,adm:!1,actions:!1}}),o=c.days[f],o.total+=l,o.persons.indexOf(s.owner_id)<0&&o.persons.push(s.owner_id),o.events.push(s),s.decaleY=o.persons.indexOf(s.owner_id),1==s.validableSci&&(a.credentials.sci=r.credentials.sci=c.credentials.sci=o.credentials.sci=a.credentials.actions=r.credentials.actions=c.credentials.actions=o.credentials.actions=!0),1==s.validableAdm&&(a.credentials.adm=r.credentials.adm=c.credentials.adm=o.credentials.adm=a.credentials.actions=r.credentials.actions=c.credentials.actions=o.credentials.actions=!0),1==s.sendable&&(a.credentials.send=r.credentials.send=c.credentials.send=o.credentials.send=a.credentials.actions=r.credentials.actions=c.credentials.actions=o.credentials.actions=!0)}}return e}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["event","withOwner"],methods:{handlerValidate:function(){this.$emit("validateevent")}},computed:{beginAt:function(){return this.event.mmStart.format("HH:mm")},endAt:function(){return this.event.mmEnd.format("HH:mm")},cssClass:function(){return"status-"+this.event.status},color:function(){return this.colorLabel(this.event.label)},css:function(){var e=60*(this.event.mmStart.hour()-6)+this.event.mmStart.minutes(),t=60*(this.event.mmEnd.hour()-6)+this.event.mmEnd.minutes();return{top:1.75*this.event.decaleY+"em",left:100/1080*e+"%",width:100/1080*(t-e)+"%",background:this.color}}}}},function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);var r=n(7),c=n(0),o=c(s.a,r.a,!1,null,null,null);t.default=o.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),s=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);var r=n(6),c=n(0),o=c(s.a,r.a,!1,null,null,null);t.default=o.exports},function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",{staticClass:"list-item",class:{"event-editable":e.event.editable,"status-info":e.event.isInfo,"status-external":e.event.isExternal,"status-draft":e.event.isDraft,"status-send":e.event.isSend,"status-valid":e.event.isValid,"status-reject":e.event.isReject,"valid-sci":e.event.isValidSci,"valid-adm":e.event.isValidAdm,"reject-sci":e.event.isRejectSci,"reject-adm":e.event.isRejectAdm},style:e.css},[n("time",{staticClass:"start"},[e._v(e._s(e.beginAt))]),e._v(" -\n    "),n("time",{staticClass:"end"},[e._v(e._s(e.endAt))]),e._v(" "),n("strong",[e._v(e._s(e.event.label))]),e._v(" "),n("div",{staticClass:"details"},[n("h4",[n("i",{staticClass:"picto",style:{background:e.color}}),e._v("\n            "+e._s(e.event.label)+" "+e._s(e.event.status))]),e._v(" "),n("p",{staticClass:"time"},[e._v("\n            de "),n("time",{staticClass:"start"},[e._v(e._s(e.beginAt))]),e._v(" à "),n("time",{staticClass:"end"},[e._v(e._s(e.endAt))]),e._v(", "),n("em",[e._v(e._s(e.event.duration))]),e._v(" heure(s) ~ état : "),n("em",[e._v(e._s(e.event.status))])]),e._v(" "),n("p",{staticClass:"small description"},[e._v("\n            "+e._s(e.event.description)+"\n        ")]),e._v(" "),n("nav",[n("button",{staticClass:"btn btn-default btn-xs",on:{click:function(t){e.$emit("selectevent",e.event)}}},[n("i",{staticClass:"icon-calendar"}),e._v("\n                Voir la semaine")]),e._v(" "),e.event.editable?n("button",{staticClass:"btn btn-primary btn-xs",on:{click:function(t){e.$emit("editevent",e.event)}}},[n("i",{staticClass:"icon-pencil-1"}),e._v("\n                Modifier")]):e._e(),e._v(" "),e.event.sendable?n("button",{staticClass:"btn btn-primary btn-xs",on:{click:function(t){e.$emit("submitevent",e.event)}}},[n("i",{staticClass:"icon-right-big"}),e._v("\n                Soumettre")]):e._e(),e._v(" "),e.event.deletable?n("button",{staticClass:"btn btn-primary btn-xs",on:{click:function(t){e.$emit("deleteevent",e.event)}}},[n("i",{staticClass:"icon-trash-empty"}),e._v("\n                Supprimer")]):e._e(),e._v(" "),e.event.validableSci?n("button",{staticClass:"btn btn-danger btn-xs",on:{mousedown:function(e){e.stopPropagation(),e.preventDefault()},click:function(t){t.stopPropagation(),t.preventDefault(),e.$emit("rejectscievent")}}},[n("i",{staticClass:"icon-attention-1"}),e._v("\n                Refus scientifique")]):e._e(),e._v(" "),e.event.validableAdm?n("button",{staticClass:"btn btn-danger btn-xs",on:{mousedown:function(e){e.stopPropagation(),e.preventDefault()},click:function(t){t.stopPropagation(),t.preventDefault(),e.$emit("rejectadmevent")}}},[n("i",{staticClass:"icon-attention-1"}),e._v("\n                Refus administratif")]):e._e(),e._v(" "),e.event.validableSci?n("button",{staticClass:"btn btn-success btn-xs",on:{mousedown:function(e){e.stopPropagation(),e.preventDefault()},click:function(t){t.stopPropagation(),t.preventDefault(),e.$emit("validatescievent")}}},[n("i",{staticClass:"icon-beaker"}),e._v("\n                Validation scientifique")]):e._e(),e._v(" "),e.event.validableAdm?n("button",{staticClass:"btn btn-success btn-xs",on:{mousedown:function(e){e.stopPropagation(),e.preventDefault()},click:function(t){t.stopPropagation(),t.preventDefault(),e.$emit("validateadmevent")}}},[n("i",{staticClass:"icon-archive"}),e._v("\n                Validation administrative")]):e._e()])])])},s=[],a={render:i,staticRenderFns:s};t.a=a},function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"calendar calendar-list"},[e._l(e.listEvents,function(t,i){return e.store?n("section",{staticClass:"year-pack"},[n("h2",{staticClass:"flex-position"},[n("strong",[n("span",{on:{click:function(t){e.toggle(i)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:-1==e.store.listEventsOpen.indexOf(i),expression:"store.listEventsOpen.indexOf(year) == -1"}],staticClass:"icon-right-dir"}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.store.listEventsOpen.indexOf(i)>=0,expression:"store.listEventsOpen.indexOf(year) >= 0"}],staticClass:"icon-down-dir"}),e._v("\n                    "+e._s(i)+"\n                ")]),e._v(" "),t.credentials.actions?n("nav",{staticClass:"reject-valid-group"},[n("i",{staticClass:" icon-angle-down"}),e._v(" "),n("ul",[t.credentials.send?n("li",{on:{click:function(n){n.preventDefault(),e.performYear(t,"submit")}}},[n("i",{staticClass:"icon-right-big"}),e._v(" Soumettre les créneaux de l'année")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performYear(t,"validatesci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Valider scientifiquement l'année")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performYear(t,"rejectsci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Rejeter scientifiquement l'année")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performYear(t,"validateadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Valider administrativement l'année")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performYear(t,"rejectadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Rejeter administrativement l'année")]):e._e(),e._v(" "),e._m(0,!0)])]):e._e()]),e._v(" "),n("span",{staticClass:"onright total"},[e._v(e._s(t.total)+" heure(s)")])]),e._v(" "),e._l(t.months,function(t,s){return n("section",{directives:[{name:"show",rawName:"v-show",value:e.store.listEventsOpen.indexOf(i)>=0,expression:"store.listEventsOpen.indexOf(year) >= 0"}],staticClass:"month-pack"},[n("h3",{staticClass:"flex-position"},[n("strong",[n("span",{on:{click:function(t){e.toggle(i+"-"+s)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:-1==e.store.listEventsOpen.indexOf(i+"-"+s),expression:"store.listEventsOpen.indexOf(year+'-'+month) == -1"}],staticClass:"icon-right-dir"}),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.store.listEventsOpen.indexOf(i+"-"+s)>=0,expression:"store.listEventsOpen.indexOf(year+'-'+month) >= 0"}],staticClass:"icon-down-dir"}),e._v("\n                    "+e._s(s)+"\n                ")]),e._v(" "),t.credentials.actions?n("nav",{staticClass:"reject-valid-group"},[n("i",{staticClass:" icon-angle-down"}),e._v(" "),n("ul",[t.credentials.send?n("li",{on:{click:function(n){n.preventDefault(),e.performMonth(t,"submit")}}},[n("i",{staticClass:"icon-right-big"}),e._v(" Soumettre les créneaux du mois")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performMonth(t,"validatesci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Valider scientifiquement le mois")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performMonth(t,"rejectsci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Rejeter scientifiquement le mois")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performMonth(t,"validateadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Valider administrativement le mois")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performMonth(t,"rejectadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Rejeter administrativement le mois")]):e._e()])]):e._e()]),e._v(" "),n("span",{staticClass:"onright total"},[e._v(e._s(t.total)+" heure(s)")])]),e._v(" "),e._l(t.weeks,function(t,a){return n("section",{directives:[{name:"show",rawName:"v-show",value:e.store.listEventsOpen.indexOf(i+"-"+s)>=0,expression:"store.listEventsOpen.indexOf(year+'-'+month) >= 0"}],staticClass:"week-pack"},[n("h4",{staticClass:"flex-position"},[n("strong",[e._v("Semaine "+e._s(a)+" ~\n                        "),t.credentials.actions?n("nav",{staticClass:"reject-valid-group"},[n("i",{staticClass:" icon-angle-down"}),e._v(" "),n("ul",[t.credentials.send?n("li",{on:{click:function(n){n.preventDefault(),e.performWeek(t,"submit")}}},[n("i",{staticClass:"icon-right-big"}),e._v(" Soumettre les créneaux de la semaine")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performWeek(t,"validatesci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Valider scientifiquement la semaine")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performWeek(t,"rejectsci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Rejeter scientifiquement la semaine")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performWeek(t,"validateadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Valider administrativement la semaine")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performWeek(t,"rejectadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Rejeter administrativement la semaine")]):e._e()])]):e._e()]),e._v(" "),n("span",{staticClass:"onright total"},[e._v(e._s(t.total)+" heure(s)")])]),e._v(" "),e._l(t.days,function(t,i){return n("section",{staticClass:"day-pack events"},[n("h5",[e._v(e._s(i)+"\n                        "),t.credentials.actions?n("nav",{staticClass:"reject-valid-group"},[n("i",{staticClass:" icon-angle-down"}),e._v(" "),n("ul",[t.credentials.send?n("li",{on:{click:function(n){n.preventDefault(),e.performDay(t,"submit")}}},[n("i",{staticClass:"icon-right-big"}),e._v(" Soumettre les créneaux de la journée")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performDay(t,"validatesci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Valider scientifiquement la journée")]):e._e(),e._v(" "),t.credentials.sci?n("li",{on:{click:function(n){n.preventDefault(),e.performDay(t,"rejectsci")}}},[n("i",{staticClass:"icon-beaker"}),e._v("Rejeter scientifiquement la journée")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performDay(t,"validateadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Valider administrativement la journée")]):e._e(),e._v(" "),t.credentials.adm?n("li",{on:{click:function(n){n.preventDefault(),e.performDay(t,"rejectadm")}}},[n("i",{staticClass:"icon-archive"}),e._v("Rejeter administrativement la journée")]):e._e()])]):e._e()]),e._v(" "),n("section",{staticClass:"events-list",style:{height:1.8*t.persons.length+"em"}},e._l(t.events,function(t){return n("listitem",{key:t.id,attrs:{"with-owner":e.withOwner,event:t},on:{selectevent:e.selectEvent,editevent:function(n){e.$emit("editevent",t)},deleteevent:function(n){e.$emit("deleteevent",t)},submitevent:function(n){e.$emit("submitevent",t)},rejectscievent:function(n){e.$emit("rejectevent",t,"sci")},rejectadmevent:function(n){e.$emit("rejectevent",t,"adm")},validatescievent:function(n){e.$emit("validateevent",t,"sci")},validateadmevent:function(n){e.$emit("validateevent",t,"adm")}}})})),e._v(" "),n("div",{staticClass:"total"},[e._v("\n                        "+e._s(t.total)+" heure(s)\n                    ")])])})],2)})],2)})],2):e._e()}),e._v(" "),e.listEvents?e._e():n("div",{staticClass:"alert alert-danger"},[e._v("\n        Aucun créneaux détéctés\n    ")])],2)},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[n("i",{staticClass:"icon-archive"}),e._v(" Suprimmer les créneaux affichés")])}],a={render:i,staticRenderFns:s};t.a=a}])});
//# sourceMappingURL=ListView.js.map