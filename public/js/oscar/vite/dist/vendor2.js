import{h as T,a as k,r as V,o as n,c as l,b as e,d as a,t as r,e as u,k as g,g as S,w as D,v as M,F as h,f as p,i as N,j as x,n as f,p as L,m as E}from"./vendor.js";import{D as A,P as Y}from"./vendor3.js";import{_ as F}from"./vendor4.js";T.locale("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd’hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(s){return s+(s===1?"er":"e")},meridiemParse:/PD|MD/,isPM:function(s){return s.charAt(0)==="M"},meridiem:function(s,o,_){return s<12?"PD":"MD"},week:{dow:1,doy:4}});const As={timeAgo(s,o="Non définie"){return s?T(s).fromNow():o},date(s,o="Non définie"){return s?"le "+T(s).format("D MMMM YYYY"):o},dateFull(s,o="Non définie"){return s?this.date(s)+" ("+this.timeAgo(s)+")":o}},Ys={filesize(s,o="Inconnue"){if(s){let _="o";return s>1e3&&(s=Math.round(s/1e3),_="Ko"),s>1e3&&(s=Math.round(s/1e3),_="Mo"),s+" "+_}else return o}},C={error(s){return s.request&&s.request.status===403?"Authorisation insuffisante (ou vous avez été déconnecté)":s.response?s.response.data?s.response.data:"Pas de message d'erreur":s.message?s.message:"Erreur inconnue"}};const O={components:{"date-picker":A,"person-auto-completer":Y},props:{editable:{default:!1},displayActivity:{default:!1},documents:{default:[]},signProcess:{default:null},tabs:{default:[]},types:{default:[]},displayButtonSign:{default:!0}},data(){return{deleteDocument:null,signDocument:null,signProcessError:"",selectedSignProcess:null,processDetails:null,error:null,editedDocument:null,mode:null,fileToDownload:null}},methods:{urlShow(s=null){if(console.log(s),s)document.location=s;else return!1},handlerToggleCheck(s){s.forEach(o=>{o.selected=!o.selected})},handlerProcessInit(s){console.log("Affichage fenêtre de signature"),this.signDocument=s},handlerPerformSignDocumentDisabled(s,o){if(!o||o.missing_recipients)return!0;for(let _=0;_<o.steps.length;_++){let v=o.steps[_],i=v.editable,m=0;for(let b=0;b<v.recipients.length;b++){let P=v.recipients[b];i?P.selected==!0&&m++:m++}if(m==0)return this.signProcessError="L'étape "+v.order+' "'+v.label+`" n'a pas de destinataire.`,!0}return this.signProcessError="",!1},handlerSelectProcess(s){this.signProcessError="",this.selectedSignProcess=s},handlerPerformSignDocument(s,o){let _=new FormData,v=s.urlProcessCreate;return _.append("document_id",s.id),_.append("flow_datas",JSON.stringify(o)),k.post(v,_).then(i=>{this.signDocument=null,this.selectedSignProcess=null,this.$emit("fetch")},i=>{this.error=C.error(i)}),!1},handlerProcessDetailsOn(s){this.processDetails=s},handlerDeleteProcess(s){console.log("handlerDeleteProcess",s),k.post(s.urlProcessDelete).then(o=>{this.$emit("fetch")},o=>{this.error=C.error(o)})},handlerDeleteDocument(s){this.deleteDocument=s},handlerDeleteDocumentConfirm(){console.log(this.deleteDocument.urlDelete),k.post(this.deleteDocument.urlDelete).then(s=>{this.$emit("fetch")},s=>{this.error=C.error(s)}),this.deleteDocument=null},handlerEdit(s){this.mode="edit",this.editedDocument=s},handlerEditConfirm(){let s=new FormData,o="";if(s.append("data",JSON.stringify(this.editedDocument)),this.mode=="version"?(s.append("action","version"),o=this.editedDocument.urlReupload):this.mode=="new"?(s.append("action","new"),o=this.urlUploadNewDoc):this.mode=="edit"&&(s.append("action","edit"),o=this.editedDocument.urlEdit),this.mode!="edit")if(this.fileToDownload!==null)s.append("file",this.fileToDownload,this.fileToDownload.name);else{this.error="Aucun fichier sélectionner a téléverser !";return}k.post(o,s).then(_=>{this.editedDocument=null,this.$emit("fetch")},_=>{this.error=C.error(_)})},handlerChangeFile(s){event.target.files.length!==0&&(this.fileToDownload=event.target.files[0])},handlerNewVersion(s){console.log("handlerNewVersion"),this.fileToDownload=null,this.mode="version",this.editedDocument=s},handlerProcessDetailsOff(){this.processDetails=null},handlerProcessReload(s){let o=new FormData;k.post(s.urlProcessUpdate,o).then(_=>{this.$emit("fetch")},_=>{this.error=C.error(_)})}}},d=s=>(L("data-v-a1221a81"),s=s(),E(),s),U={key:0,class:"overlay",style:{"z-index":"10000"}},j={class:"overlay-content",style:{"max-width":"50%"}},I={key:1,class:"overlay"},H={class:"overlay-content"},q={class:"alert-danger alert"},B=d(()=>e("i",{class:"icon-attention-1"},null,-1)),X=d(()=>e("i",{class:"icon-cancel-alt"},null,-1)),z=d(()=>e("i",{class:"icon-valid"},null,-1)),R={key:2,class:"overlay"},J={class:"overlay-content"},W=d(()=>e("i",{class:"icon-doc"},null,-1)),K={key:0},G={key:1},Q={key:2},Z=d(()=>e("br",null,null,-1)),$={key:0},ee={key:1},te={class:"row"},se={class:"col-md-6"},ne={key:0},le=d(()=>e("label",{for:"file"},"Fichier",-1)),oe=d(()=>e("label",{for:"dateDeposit"},"Date de dépôt",-1)),ie=d(()=>e("label",{for:"dateSend"},"Date d'envoi",-1)),re={class:"col-md-6"},ae={key:0},ce=d(()=>e("label",{for:"tabdocument"},"Onglet",-1)),de=["value"],ue={key:1},_e=d(()=>e("label",{for:"typedocument"},"Type de document",-1)),me={key:0,class:"alert alert-warning"},he={key:1},pe=["value","disabled"],fe={class:"col-md-12"},ve=d(()=>e("label",{for:"information"},"Informations",-1)),ge={key:0,class:"col-md-6"},De={class:"row"},be={key:0},ye=d(()=>e("label",{for:"tabdocument"},"Onglet document",-1)),ke=["value"],Ce=d(()=>e("div",{class:"col-md-6"},[e("label",{for:"private"},"Document privé")],-1)),Pe={class:"col-md-6"},we={key:0},Se=d(()=>e("label",null,"Choix des personnes ayant accès à ce document",-1)),Me=d(()=>e("h3",null,"Ce document sera classé automatiquement dans l'onglet privé",-1)),xe=d(()=>e("i",{class:"icon-cube"},null,-1)),Te={class:"addon"},Ve=["onClick"],Ne={class:"row"},Le={class:"col-md-12"},Ee={class:"buttons-bar"},Ae=d(()=>e("i",{class:"icon-cancel-alt"},null,-1)),Ye=d(()=>e("i",{class:"icon-valid"},null,-1)),Fe={key:3,class:"overlay"},Oe={class:"overlay-content"},Ue={key:0,class:"alert alert-danger"},je={key:1},Ie=["onClick"],He=d(()=>e("br",null,null,-1)),qe={key:0},Be=d(()=>e("small",null,"Procédure de signature",-1)),Xe=d(()=>e("br",null,null,-1)),ze={class:"metas"},Re={class:"meta"},Je={class:"meta"},We={class:"meta"},Ke={key:0,class:"alert alert-danger"},Ge={class:"row"},Qe={class:"col-md-6"},Ze=d(()=>e("i",{class:"icon-group"},null,-1)),$e=["onClick"],et=["for"],tt={class:"fullname"},st=["onUpdate:modelValue","id"],nt={style:{"font-weight":"300"}},lt={class:"email",style:{"font-weight":"500"}},ot={class:"col-md-6"},it=d(()=>e("i",{class:"icon-bell-alt"},null,-1)),rt=d(()=>e("strong",null,"Observateurs",-1)),at=["onClick"],ct=["for"],dt={class:"fullname"},ut=["id","onUpdate:modelValue"],_t={style:{"font-weight":"300"}},mt={class:"email",style:{"font-weight":"500"}},ht={key:1,class:"alert alert-info"},pt={key:2,class:"alert alert-danger"},ft={class:"buttons-bar"},vt=d(()=>e("i",{class:"icon-cancel-alt"},null,-1)),gt=d(()=>e("i",{class:"icon-cancel-alt"},null,-1)),Dt={key:4,class:"overlay"},bt={class:"overlay-content",style:{"max-width":"50%"}},yt=d(()=>e("small",null,[e("i",{class:"icon-edit"}),a(" Procédure")],-1)),kt=d(()=>e("br",null,null,-1)),Ct=d(()=>e("br",null,null,-1)),Pt={class:"signature-status-101"},wt={class:"status"},St={class:"metas"},Mt={class:"meta"},xt={class:"meta"},Tt={class:"meta"},Vt={class:"fullname"},Nt={class:"email"},Lt={class:"status"},Et={class:"status-text"},At=d(()=>e("strong",null,"Observateurs : ",-1)),Yt={class:"observer-inline"},Ft={class:"buttons-bar"},Ot=d(()=>e("i",{class:"icon-cancel-outline"},null,-1)),Ut={class:"card-title"},jt={key:0,class:"picto icon-anchor-outline"},It={class:"text-light"},Ht=["title"],qt=d(()=>e("i",{class:"icon-briefcase"},null,-1)),Bt=d(()=>e("i",{class:"icon-calendar"},null,-1)),Xt=d(()=>e("i",{class:"icon-calendar"},null,-1)),zt=d(()=>e("i",{class:"icon-calendar"},null,-1)),Rt=d(()=>e("i",{class:"icon-user"},null,-1)),Jt={key:0},Wt={key:1},Kt={key:0},Gt=d(()=>e("i",{class:"icon-lock"},null,-1)),Qt={class:"cartouche"},Zt={class:"card-content"},$t=d(()=>e("i",{class:"icon-hammer"},null,-1)),es=["onClick"],ts=d(()=>e("i",{class:"icon-help-circled"},null,-1)),ss=["onClick"],ns=d(()=>e("i",{class:"icon-trash"},null,-1)),ls=["onClick"],os=d(()=>e("i",{class:"icon-cw-outline"},null,-1)),is={key:1},rs=["onClick"],as=d(()=>e("i",{class:"icon-cube"},null,-1)),cs={key:0},ds=d(()=>e("i",{class:"icon-cubes"},null,-1)),us={key:2},_s=d(()=>e("div",{class:"exploder"}," Versions précédentes : ",-1)),ms={class:"subdoc text-highlight"},hs={key:0},ps=["href"],fs=d(()=>e("i",{class:"icon-download-outline"},null,-1)),vs={class:"text-right show-over"},gs=["href"],Ds=d(()=>e("i",{class:"icon-link-ext"},null,-1)),bs=["onClick"],ys=d(()=>e("i",{class:"icon-bank"},null,-1)),ks=["href"],Cs=d(()=>e("i",{class:"icon-upload-outline"},null,-1)),Ps=["onClick"],ws=d(()=>e("i",{class:"icon-download-outline"},null,-1)),Ss=["onClick"],Ms=d(()=>e("i",{class:"icon-trash"},null,-1)),xs=["onClick"],Ts=d(()=>e("i",{class:"icon-pencil"},null,-1));function Vs(s,o,_,v,i,m){const b=V("date-picker"),P=V("person-auto-completer");return n(),l(h,null,[i.error?(n(),l("div",U,[e("div",j,[e("h2",null,[a(" Erreur "),e("span",{class:"overlay-closer",onClick:o[0]||(o[0]=t=>i.error=null)},"X")]),e("p",null,r(i.error.response&&i.error.response.data?i.error.response.data:i.error),1)])])):u("",!0),i.deleteDocument?(n(),l("div",I,[e("div",H,[e("h2",null,[a(" Supprimer le document ? "),e("span",{class:"overlay-closer",onClick:o[1]||(o[1]=t=>i.deleteDocument=null)},"X")]),e("p",q,[B,a(" Souhaitez-vous supprimer le fichier "),e("strong",null,r(i.deleteDocument.fileName),1),a(" ? ")]),e("button",{class:"btn btn-danger",onClick:o[2]||(o[2]=t=>i.deleteDocument=null)},[X,a(" Annuler ")]),e("a",{class:"btn btn-success",onClick:o[3]||(o[3]=g(t=>m.handlerDeleteDocumentConfirm(),["prevent"]))},[z,a(" Confirmer ")])])])):u("",!0),i.editedDocument?(n(),l("div",R,[e("div",J,[e("h2",null,[e("small",null,[W,i.mode=="new"?(n(),l("span",K,"Téléversement d'un document")):u("",!0),i.mode=="edit"?(n(),l("span",G,"Modification des informations")):u("",!0),i.mode=="version"?(n(),l("span",Q,"Nouvelle version")):u("",!0)]),Z,i.editedDocument.id>0?(n(),l("span",$,[e("strong",null,r(i.editedDocument.fileName),1)])):(n(),l("span",ee,[a(" Nouveau document dans "),e("strong",null,r(i.editedDocument.tabDocument.label),1)])),e("span",null," ("+r(i.mode)+") ",1),e("span",{class:"overlay-closer",onClick:o[4]||(o[4]=t=>i.editedDocument=null)},"X")]),e("div",te,[e("div",se,[i.mode!="edit"?(n(),l("div",ne,[le,e("input",{onChange:o[5]||(o[5]=(...t)=>m.handlerChangeFile&&m.handlerChangeFile(...t)),type:"file",class:"form-control",name:"file",id:"file"},null,32)])):u("",!0),e("div",null,[oe,S(b,{modelValue:i.editedDocument.dateDeposit,"onUpdate:modelValue":o[6]||(o[6]=t=>i.editedDocument.dateDeposit=t),id:"dateDeposit"},null,8,["modelValue"])]),e("div",null,[ie,S(b,{modelValue:i.editedDocument.dateSend,"onUpdate:modelValue":o[7]||(o[7]=t=>i.editedDocument.dateSend=t),id:"dateSend"},null,8,["modelValue"])])]),e("div",re,[i.mode!="version"?(n(),l("div",ae,[ce,e("div",null,[D(e("select",{name:"tabdocument",id:"tabdocument","onUpdate:modelValue":o[8]||(o[8]=t=>i.editedDocument.tabDocument.id=t),class:"form-control"},[(n(!0),l(h,null,p(_.tabs,(t,c)=>(n(),l("option",{value:c,key:c},r(t.label),9,de))),128))],512),[[M,i.editedDocument.tabDocument.id]])])])):u("",!0),i.mode!="version"?(n(),l("div",ue,[_e,i.editedDocument.process?(n(),l("div",me," Vous ne pouvez pas modifier le type d'un document engagé dans un processus de signature. ")):(n(),l("div",he,[D(e("select",{class:"form-control",name:"type",id:"typedocument","onUpdate:modelValue":o[9]||(o[9]=t=>i.editedDocument.category.id=t)},[(n(!0),l(h,null,p(_.types,(t,c)=>(n(),l("option",{value:t.id,key:t.id,disabled:t.flow&&i.editedDocument.id>0},r(t.label)+" "+r(t.flow&&i.editedDocument.id?"(signature)":""),9,pe))),128))],512),[[M,i.editedDocument.category.id]])]))])):u("",!0)]),e("div",fe,[ve,D(e("textarea",{"onUpdate:modelValue":o[10]||(o[10]=t=>i.editedDocument.information=t),id:"information",class:"form-control"},null,512),[[N,i.editedDocument.information]])]),i.mode=="change"?(n(),l("div",ge,[e("div",De,[i.editedDocument.private===!1?(n(),l("span",be,[ye,e("div",null,[D(e("select",{name:"tabdocument",id:"tabdocument","onUpdate:modelValue":o[11]||(o[11]=t=>i.editedDocument.tabDocument.id=t),class:"form-control"},[(n(!0),l(h,null,p(_.tabs,(t,c)=>(n(),l("option",{value:c,key:c},r(t.label),9,ke))),128))],512),[[M,i.editedDocument.tabDocument.id]])])])):u("",!0),Ce,e("div",Pe,[D(e("input",{type:"checkbox",name:"private",id:"privateModifDoc",class:"form-control","onUpdate:modelValue":o[12]||(o[12]=t=>i.editedDocument.private=t)},null,512),[[x,i.editedDocument.private]])])]),i.editedDocument.private===!0?(n(),l("span",we,[Se,Me,S(P,{onChange:s.handlerSelectPersons},null,8,["onChange"]),(n(!0),l(h,null,p(i.editedDocument.persons,t=>(n(),l("span",{key:t.id,class:"cartouche"},[xe,e("span",null,r(t.personName),1),e("span",Te,r(t.affectation),1),t.personId!==s.idCurrentPerson?(n(),l("i",{key:0,onClick:c=>s.handlerDeletePerson(t),class:"icon-trash icon-clickable"},null,8,Ve)):u("",!0)]))),128))])):u("",!0)])):u("",!0)]),e("div",Ne,[e("div",Le,[e("nav",Ee,[e("button",{class:"btn btn-danger",onClick:o[13]||(o[13]=t=>i.editedDocument=null)},[Ae,a(" Annuler ")]),e("a",{class:"btn btn-success",href:"#",onClick:o[14]||(o[14]=g(t=>m.handlerEditConfirm(),["prevent"]))},[Ye,a(" Enregistrer ")])])])])])])):u("",!0),i.signDocument?(n(),l("div",Fe,[e("div",Oe,[e("h2",null,[a(" Signature de document numérique "),e("span",{class:"overlay-closer",onClick:o[15]||(o[15]=t=>i.signDocument=null)},"X")]),_.signProcess?(n(),l("div",je,[e("nav",null,[a(" Sélectionnez une procédure de signature "),(n(!0),l(h,null,p(_.signProcess,t=>(n(),l("span",{class:f(["btn btn-lg btn-default",{"btn-success":i.selectedSignProcess&&i.selectedSignProcess.id==t.id}]),onClick:c=>m.handlerSelectProcess(t)},[e("strong",null,r(t.label),1),He,e("em",null,r(t.description)+" ",1)],10,Ie))),256))]),i.selectedSignProcess?(n(),l("section",qe,[e("h3",null,[Be,Xe,e("strong",null,r(i.selectedSignProcess.label),1)]),(n(!0),l(h,null,p(i.selectedSignProcess.steps,t=>(n(),l("article",{class:f(["step",t.missing_recipients?"error":"ok"])},[e("h4",null,[a("ÉTAPE "+r(t.order)+" :",1),e("strong",null,r(t.label),1)]),e("ul",ze,[e("li",Re,[a("Parapheur: "),e("strong",null,r(t.letterfile_label),1)]),e("li",Je,[a("Type: "),e("strong",null,r(t.level_label),1)]),e("li",We,[a("Tous signent: "),e("strong",null,r(t.allSignToComplete?"Oui":"non"),1)])]),t.missing_recipients?(n(),l("div",Ke," Il manque des destinataires pour cette procédure. ")):u("",!0),e("div",Ge,[e("div",Qe,[e("h5",null,[Ze,a(" Destinataires - "),e("a",{href:"#",onClick:g(c=>m.handlerToggleCheck(t.recipients),["prevent"])},"Inverser selection",8,$e)]),(n(!0),l(h,null,p(t.recipients,(c,y)=>(n(),l("div",{class:f(["recipient",{selected:c.selected}])},[e("label",{for:"des_"+t.id+"_"+y},[e("span",tt,[t.editable?D((n(),l("input",{key:0,type:"checkbox","onUpdate:modelValue":w=>c.selected=w,id:"des_"+t.id+"_"+y},null,8,st)),[[x,c.selected]]):u("",!0),a("   "),e("em",nt,r(c.firstname),1),a(" "+r(c.lastname),1)]),e("small",lt,r(c.email),1)],8,et)],2))),256))]),e("div",ot,[e("h5",null,[it,rt,a(" - "),e("a",{href:"#",onClick:g(c=>m.handlerToggleCheck(t.observers),["prevent"])},"Inverser selection",8,at)]),t.observers.length?(n(!0),l(h,{key:0},p(t.observers,(c,y)=>(n(),l("div",{class:f(["recipient",{selected:c.selected}])},[e("label",{for:"obs_"+t.id+"_"+y},[e("span",dt,[t.editable?D((n(),l("input",{key:0,type:"checkbox",id:"obs_"+t.id+"_"+y,"onUpdate:modelValue":w=>c.selected=w},null,8,ut)),[[x,c.selected]]):u("",!0),a("   "),e("em",_t,r(c.firstname),1),a(" "+r(c.lastname),1)]),e("small",mt,r(c.email),1)],8,ct)],2))),256)):(n(),l("div",ht," Pas d'observateur pour cette étape "))])])],2))),256))])):u("",!0)])):(n(),l("div",Ue," Aucun processus de signature disponible ")),i.signProcessError?(n(),l("div",pt,[a(" Signature non-disponible : "),e("strong",null,r(i.signProcessError),1)])):u("",!0),e("nav",ft,[e("button",{class:"btn btn-default",onClick:o[16]||(o[16]=t=>i.signDocument=null)},[vt,a(" Annuler ")]),e("button",{class:f(["btn btn-success",{disabled:m.handlerPerformSignDocumentDisabled(i.signDocument,i.selectedSignProcess)}]),onClick:o[17]||(o[17]=t=>m.handlerPerformSignDocument(i.signDocument,i.selectedSignProcess))},[gt,a(" Valider ")],2)])])])):u("",!0),i.processDetails?(n(),l("div",Dt,[e("div",bt,[e("h2",null,[yt,a(),kt,e("strong",null,r(i.processDetails.label),1),a(),Ct,e("span",Pt,[a(r(i.processDetails.status_text)+" - ",1),e("em",null,"étape "+r(i.processDetails.current_step)+" / "+r(i.processDetails.total_steps),1)]),e("span",{class:"overlay-closer",onClick:o[18]||(o[18]=(...t)=>m.handlerProcessDetailsOff&&m.handlerProcessDetailsOff(...t))},"X")]),(n(!0),l(h,null,p(i.processDetails.steps,t=>(n(),l("section",{class:f(["signature","signature-status-"+t.status])},[e("h4",null,[e("small",null,"étape "+r(t.order)+" : ",1),e("strong",null,r(t.label),1),e("span",wt," ("+r(t.status_text)+")",1)]),e("ul",St,[e("li",Mt,[a("Parapheur "),e("strong",null,r(t.letterfile),1)]),e("li",xt,[a("Niveau "),e("strong",null,r(t.level),1)]),e("li",Tt,[a("Tous les destinataires signent "),e("strong",null,r(t.allSignToComplete?"Oui":"Non"),1)])]),(n(!0),l(h,null,p(t.recipients,c=>(n(),l("article",{class:f(["recipient","signature-status-"+c.status])},[e("strong",Vt,r(c.fullname),1),e("em",Nt,r(c.email),1),e("small",null,r(s.$filters.dateFull(c.dateFinished)),1),e("span",Lt,[e("span",Et,r(c.status_text),1)])],2))),256)),At,(n(!0),l(h,null,p(t.observers,c=>(n(),l("span",Yt,[e("small",null,r(c.firstname),1),a(),e("span",null,r(c.lastname),1)]))),256))],2))),256)),e("div",Ft,[e("button",{class:"btn btn-default",onClick:o[19]||(o[19]=(...t)=>m.handlerProcessDetailsOff&&m.handlerProcessDetailsOff(...t))},[Ot,a(" Fermer ")])])])])):u("",!0),(n(!0),l(h,null,p(_.documents,t=>(n(),l("article",{class:f(["card xs",{"private-document":t.private}]),key:t.id},[e("div",Ut,[t.location=="link"?(n(),l("i",jt)):(n(),l("i",{key:1,class:f(["picto icon-doc","doc"+t.extension])},null,2)),e("small",It,r(t.category.label)+" ~ ",1),e("strong",null,r(t.fileName),1),t.location!="url"?(n(),l("small",{key:2,class:"text-light",title:t.fileSize+" octet(s)"},"  Version "+r(t.version),9,Ht)):u("",!0)]),e("small",null,[qt,a(" Taille "),e("strong",null,r(s.$filters.filesize(t.fileSize)),1),Bt,a(" Envoyé "),e("strong",null,r(s.$filters.timeAgo(t.dateSend)),1),Xt,a(" Déposé "),e("strong",null,r(s.$filters.dateFull(t.dateDeposit)),1),zt,a(" Uploadé "),e("strong",null,r(s.$filters.dateFull(t.dateUpload)),1),Rt,a(" par "),t.uploader?(n(),l("strong",Jt,r(t.uploader.displayname),1)):(n(),l("em",Wt,"Inconnu"))]),e("p",null,r(t.information),1),t.private?(n(),l("section",Kt,[Gt,a(" Ce document est privé, accessible par : "),(n(!0),l(h,null,p(t.persons,c=>(n(),l("span",Qt,r(c.personName),1))),256))])):u("",!0),e("div",Zt,[t.process?(n(),l("section",{key:0,class:f(["alert",{"alert-success":t.process.status==201,"alert-danger":t.process.status>=400,"alert-info":t.process.status<200}])},[$t,a(" Procédure de signature "),e("strong",null,r(t.process.label),1),a(" ("),e("em",null,r(t.process.status_text),1),e("span",null," - étape "+r(t.process.current_step)+" / "+r(t.process.total_steps),1),a(") "),e("button",{class:"btn btn-xs btn-info",onClick:c=>m.handlerProcessDetailsOn(t.process)},[ts,a(" Détails ")],8,es),t.urlProcessDelete?(n(),l("button",{key:0,class:"btn btn-xs btn-danger",onClick:c=>m.handlerDeleteProcess(t)},[ns,a(" Annuler la procédure ")],8,ss)):u("",!0),t.urlProcessUpdate?(n(),l("button",{key:1,class:"btn btn-default btn-xs",onClick:c=>m.handlerProcessReload(t)},[os,a(" Actualiser ")],8,ls)):u("",!0)],2)):u("",!0),_.displayActivity?(n(),l("section",is,[a(" Activité : "),e("span",{class:f({link:t.activity.url_show}),onClick:c=>m.urlShow(t.activity.url_show)},[e("strong",null,[as,a(" / "+r(t.activity.num),1)]),a("  "),e("em",null,r(t.activity.label),1),t.activity.project_id?(n(),l("small",cs,[a(" ("),ds,a(r(t.activity.project_acronym)+") ",1)])):u("",!0)],10,rs)])):u("",!0),t.versions&&t.versions.length?(n(),l("div",us,[_s,(n(!0),l(h,null,p(t.versions,c=>(n(),l("article",ms,[e("i",{class:f(["picto icon-doc","doc"+c.extension])},null,2),e("strong",null,r(c.fileName),1),a(" version "),e("em",null,r(c.version),1),a(", téléchargé le "),e("time",null,r(c.dateUpload|s.dateFullSort),1),c.uploader?(n(),l("span",hs,[a(" par "),e("strong",null,r(c.uploader.displayname),1)])):u("",!0),e("a",{href:c.urlDownload},[fs,a(" Télécharger cette version ")],8,ps)]))),256))])):u("",!0),e("nav",vs,[t.location=="url"?(n(),l("a",{key:0,class:"btn btn-default btn-xs",href:t.basename,target:"_blank"},[Ds,a(" Accéder au lien ")],8,gs)):u("",!0),t.process_triggerable&&_.displayButtonSign?(n(),l("a",{key:1,class:"btn btn-default btn-xs",href:"#",onClick:g(c=>m.handlerProcessInit(t),["prevent"])},[ys,a(" Signer ce document ")],8,bs)):u("",!0),t.urlDownload&&t.location!="url"?(n(),l("a",{key:2,class:"btn btn-default btn-xs",href:t.urlDownload},[Cs,a(" Télécharger ")],8,ks)):u("",!0),t.urlReupload?(n(),l("button",{key:3,onClick:c=>m.handlerNewVersion(t),class:"btn btn-default btn-xs"},[ws,a(" Nouvelle Version ")],8,Ps)):u("",!0),t.urlDelete?(n(),l("a",{key:4,class:"btn btn-default btn-xs",onClick:g(c=>m.handlerDeleteDocument(t),["prevent"])},[Ms,a(" Supprimer ")],8,Ss)):u("",!0),t.urlEdit?(n(),l("a",{key:5,class:"btn btn-xs btn-default",href:"#",onClick:g(c=>m.handlerEdit(t),["prevent"])},[Ts,a(" Modifier ")],8,xs)):u("",!0)])])],2))),128))],64)}const Fs=F(O,[["render",Vs],["__scopeId","data-v-a1221a81"]]);export{Fs as D,Ys as f,As as m};
