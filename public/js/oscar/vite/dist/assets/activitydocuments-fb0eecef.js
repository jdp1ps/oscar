import{a as y,h as E,r as P,c as o,b as e,d as m,t as r,e as p,F as f,f as D,g as k,w as b,v as C,i as U,j as T,k as I,n as v,l as F,o as i,p as O,m as M,q as R}from"../vendor.js";import{D as W,a as A,P as z,m as x,f as q}from"../vendor2.js";import{_ as j}from"../vendor3.js";const B="private",X={components:{"document-list":W,"date-picker":A,"person-auto-completer":z},props:{urlUploadNewDoc:{required:!0},urlSignDocument:{required:!1},url:{required:!0}},data(){return{idCurrentPerson:null,persons:[],computedDocuments:[],dateDeposit:"",dateSend:"",fileUrl:"",fileUrlLabel:"",privateDocument:!1,selectedIdTypeDocument:null,selectedIdTabDocument:null,informationsDocument:"",fileToDownload:null,uploadNewDocData:{dateDeposit:this.dateDeposit,dateSend:this.dateSend,private:this.privateDocument,type:this.selectedIdTypeDocument,tab:this.selectedIdTabDocument,informations:this.informationsDocument,persons:this.persons,baseUrlUpload:this.urlUploadNewDoc,url:"",init:!1},errorMessages:[],tabId:null,tabsWithDocuments:null,formData:null,error:null,deleteData:null,editData:null,uploadDoc:null,documents:[],loading:!0,sortField:"dateUpload",sortDirection:-1,editable:!0,remoterState:null,displayComputed:!1,signDocument:null,signProcess:null,selectedSignProcess:null,signProcessError:"",editedDocument:null,mode:null,processDetails:null,mode_url:!1,typesDocuments:[],selectedTab:null,selectedTabId:null}},computed:{currentFlow(){if(this.editedDocument.category.id){let s=this.typesDocuments.find(l=>l.id==this.editedDocument.category.id);if(console.log(s),s.flow)return s.flow.signatureflow}return!1},selectedTypeDocument(){return this.selectedIdTypeDocument?(console.log(this.typesDocuments),this.typesDocuments.find(s=>s.id==this.selectedIdTypeDocument)):null},documentsPacked(){let s=[];return this.documents&&(s=this.documents.sort(function(c,h){return c[this.sortField]<h[this.sortField]?-1*this.sortDirection:c[this.sortField]>h[this.sortField]?1*this.sortDirection:0}.bind(this))),s},packedDocuments(){let s={};if(this.tabsWithDocuments)for(const[l,c]of Object.entries(this.tabsWithDocuments)){let h={};for(const[t,d]of Object.entries(c.documents)){let _=d.fileName;h.hasOwnProperty(_)?h[_].versions.push(d):(d.versions=[],h[_]=d)}s[l]={id:c.id,label:c.label,total:c.total,description:c.description,manage:c.manage,roles:c.roles,documents:h}}return s}},methods:{handlerPerformSignDocumentDisabled(s,l){if(!l||l.missing_recipients)return!0;for(let c=0;c<l.steps.length;c++){let h=l.steps[c],t=h.editable,d=0;for(let _=0;_<h.recipients.length;_++){let g=h.recipients[_];t?g.selected==!0&&d++:d++}if(d==0)return this.signProcessError="L'étape "+h.order+' "'+h.label+`" n'a pas de destinataire.`,!0}return this.signProcessError="",!1},handlerSelectProcess(s){this.signProcessError="",this.selectedSignProcess=s},handlerPerformSignDocument(s,l){let c=new FormData,h=this.urlSignDocument;return c.append("document_id",s.id),c.append("flow_datas",JSON.stringify(l)),y.post(h,c).then(t=>{console.log("SUCCESS",t),this.signDocument=null,this.selectedSignProcess=null,this.fetch()},t=>{console.log("ERROR",t),this.error=t.response.data?t.response.data:t.message}),!1},renderDate(s){return s?E(s).fromNow():"non précisé"},handlerProcessDetailsOn(s){this.processDetails=s},handlerProcessDetailsOff(){this.processDetails=null},activeTab(s){this.tabId=s},deleteDocument(s){this.deleteData=s},handlerSignDocument(s){this.signDocument=s},order:function(s){this.sortField==s?this.sortDirection*=-1:this.sortField=s},cssStepCurrent(s){return s===this.tabId?"current":""},cssSort:function(s){return s===this.sortField?"active":""},handlerEdit(s){this.editedDocument=s,this.mode="edit"},handlerSelectPersons(s){if(s.id){let l={personName:s.displayname,personId:s.id,affectation:s.affectation},c=s.id,h=!1;this.persons.forEach(function(t){t.personId===c&&(h=!0)}),h===!1&&(this.editedDocument?(this.editedDocument.persons||(this.editedDocument.persons=[]),this.editedDocument.persons.push(l)):this.persons.push(l))}},handlerDeletePerson(s){this.persons.splice(this.persons.indexOf(s),1)},handlerNew(s){this.mode="new",this.editedDocument={id:-1,version:1,information:"",fileName:"",process:!1,process_sendable:null,fileSize:0,typeMime:null,dateUpload:null,dateDeposit:null,dateSend:null,extension:null,category:{id:null},tabDocument:this.getTabById(s),private:!1,persons:[],location:"local",urlDelete:"",urlDownload:"",urlReupload:"",uploader:null,urlPerson:!1}},handlerNewVersion(s){this.mode="version",this.editedDocument=s},uploadFile(s){s.target.files.length!==0&&(this.fileToDownload=s.target.files[0])},handlerProcessReload(s){let l=new FormData;y.post(s.manage_process,l).then(c=>{this.fetch()},c=>{console.log("ERROR",c),this.error=c.response&&c.response.data?c.response.data:c})},applyEdit(){let s=new FormData,l="";if(s.append("data",JSON.stringify(this.editedDocument)),this.mode=="version"?(s.append("action","version"),l=this.editedDocument.urlReupload):this.mode=="new"?(s.append("action","new"),s.append("flow",""),l=this.urlUploadNewDoc):this.mode=="edit"&&(s.append("action","edit"),l=this.editedDocument.urlReupload),this.mode!="edit")if(this.fileToDownload!==null)s.append("file",this.fileToDownload,this.fileToDownload.name);else{this.error="Aucun fichier sélectionner a téléverser !";return}y.post(l,s).then(c=>{console.log("SUCCESS",c),this.editedDocument=null,this.fetch()},c=>{console.log("ERROR",c),this.error=c.response&&c.response.data?c.response.data:c})},performEdit(){this.errorMessages=[];let s=[],l="",c=!0;if(this.editData.private===!0?(c=1,this.persons.length!==0&&this.persons.forEach(_=>{s.push(_.personId)})):(c=0,this.editData.tabDocument_id===B||this.editData.tabDocument_id===""?this.errorMessages.push("Vous devez sélectionner un onglet pour la modification (ce n'est pas un document qualifié privé)"):l=this.editData.tabDocument_id),this.errorMessages.length!==0)return;let h=this.editData.document.id,t=this.editData.documentype_id;this.editData=null,this.persons=[];let d=new FormData;d.append("documentId",h),d.append("type",t),d.append("tabDocument",l),d.append("private",c),d.append("persons",s)},getTabById(s){let l=this.tabsWithDocuments[s];return{id:l.id,label:l.label}},handlerSuccess(s){try{if(!s.data)throw"Impossible de charger les documents, vérifiez que vous êtes toujours connecté";this.idCurrentPerson=s.data.idCurrentPerson;let l=Array.isArray(s.data.tabsWithDocuments)?{}:s.data.tabsWithDocuments,c=null,h=null;if(l)if(Object.keys(l).forEach(t=>{let d=l[t];d.total=d.documents.length,d.documents.sort((_,g)=>g.version-_.version),d.documents.forEach(_=>{console.log(_.fileName,_.version),_.explode=!0}),c==null&&(c=d.id),h==null&&d.documents.length>0&&(h=d.id)}),this.tabsWithDocuments=l,this.computedDocuments=s.data.computedDocuments,this.signProcess=s.data.process_datas,this.typesDocuments=s.data.typesDocuments,this.selectedTabId==null&&(this.selectedTabId=h||c),this.tabsWithDocuments.unclassified&&this.tabsWithDocuments.unclassified.documents.length)this.selectedTab=this.tabsWithDocuments.unclassified;else{let t=Object.keys(this.tabsWithDocuments)[0];t.length&&(this.selectedTab=this.tabsWithDocuments[t[0]])}else throw new Error("Vous n'avez pas accès aux documents")}catch(l){this.error=l}},handlerSelectTab(s){s=="computed"?(this.displayComputed=!0,this.selectedTab=null,this.selectedTabId=null):(this.displayComputed=!1,this.selectedTab=s,this.selectedTabId=s.id)},fetch(){y.get(this.url).then(s=>{this.handlerSuccess(s)},s=>{this.error=s.response.data?s.response.data:s})}},mounted(){this.fetch()}},a=s=>(O("data-v-517e3447"),s=s(),M(),s),L={key:0,class:"overlay",style:{"z-index":"101"}},J={class:"overlay-content",style:{"max-width":"50%"}},K={class:"alert-danger alert"},G=a(()=>e("i",{class:"icon-attention-1"},null,-1)),H=a(()=>e("i",{class:"icon-cancel-outline"},null,-1)),Q={key:1,class:"overlay"},Y={class:"overlay-content",style:{"max-width":"50%"}},Z=a(()=>e("small",null,[e("i",{class:"icon-edit"}),m(" Procédure")],-1)),$=a(()=>e("br",null,null,-1)),ee=a(()=>e("br",null,null,-1)),te={class:"signature-status-101"},se={class:"status"},ne={class:"metas"},le={class:"meta"},oe={class:"meta"},ie={class:"fullname"},re={class:"email"},ce={class:"status"},de={class:"status-text"},ae=a(()=>e("strong",null,"Observateurs : ",-1)),ue={class:"buttons-bar"},me=a(()=>e("i",{class:"icon-cancel-outline"},null,-1)),he={style:{position:"relative","min-height":"100px"}},pe={key:0,class:"overlay"},_e={class:"overlay-content"},fe={class:"alert-danger alert"},De=a(()=>e("i",{class:"icon-attention-1"},null,-1)),be=a(()=>e("i",{class:"icon-cancel-alt"},null,-1)),ve=["href"],ge=a(()=>e("i",{class:"icon-valid"},null,-1)),ye={key:1,class:"overlay"},ke={class:"overlay-content"},Se=a(()=>e("i",{class:"icon-doc"},null,-1)),we={key:0},Pe={key:1},Ce={key:2},Te=a(()=>e("br",null,null,-1)),Ie={key:0},xe={key:1},Fe={class:"row"},Ne={class:"col-md-6"},Ve={key:0},Ee=a(()=>e("label",{for:"file"},"Fichier",-1)),Ue=a(()=>e("label",{for:"dateDeposit"},"Date de dépôt",-1)),Oe=a(()=>e("label",{for:"dateSend"},"Date d'envoi",-1)),Me={class:"col-md-6"},Re={key:0},We=a(()=>e("label",{for:"tabdocument"},"Onglet",-1)),Ae=["value"],ze={key:1},qe=a(()=>e("label",{for:"typedocument"},"Type de document",-1)),je={key:0,class:"alert alert-warning"},Be={key:1},Xe=["value","disabled"],Le={class:"col-md-12"},Je=a(()=>e("label",{for:"information"},"Informations",-1)),Ke={key:0,class:"col-md-6"},Ge={class:"row"},He={key:0},Qe=a(()=>e("label",{for:"tabdocument"},"Onglet document",-1)),Ye=["value"],Ze=a(()=>e("div",{class:"col-md-6"},[e("label",{for:"private"},"Document privé")],-1)),$e={class:"col-md-6"},et={key:0},tt=a(()=>e("label",null,"Choix des personnes ayant accès à ce document",-1)),st=a(()=>e("h3",null,"Ce document sera classé automatiquement dans l'onglet privé",-1)),nt=a(()=>e("i",{class:"icon-cube"},null,-1)),lt={class:"addon"},ot=["onClick"],it={class:"row"},rt={class:"col-md-12"},ct={class:"buttons-bar"},dt=a(()=>e("i",{class:"icon-cancel-alt"},null,-1)),at=a(()=>e("i",{class:"icon-valid"},null,-1)),ut={key:2,class:"overlay"},mt={class:"overlay-content"},ht=["onClick"],pt=a(()=>e("br",null,null,-1)),_t={key:0},ft=a(()=>e("small",null,"Procédure de signature",-1)),Dt=a(()=>e("br",null,null,-1)),bt={class:"metas"},vt={class:"meta"},gt={class:"meta"},yt={class:"meta"},kt={key:0,class:"alert alert-danger"},St={class:"row"},wt={class:"col-md-6"},Pt=a(()=>e("h5",null,"Destinataires",-1)),Ct={class:"recipient"},Tt=["onUpdate:modelValue"],It={class:"email"},xt={class:"fullname"},Ft={class:"col-md-6"},Nt=a(()=>e("h5",null,"Observateurs",-1)),Vt={class:"recipient"},Et=["onUpdate:modelValue"],Ut={class:"email"},Ot={class:"fullname"},Mt={key:1,class:"alert alert-info"},Rt={key:1,class:"alert alert-danger"},Wt={class:"buttons-bar"},At=a(()=>e("i",{class:"icon-cancel-alt"},null,-1)),zt=a(()=>e("i",{class:"icon-cancel-alt"},null,-1)),qt={key:3,class:"overlay"},jt={class:"overlay-content"},Bt=a(()=>e("i",{class:"icon-cancel-alt"},null,-1)),Xt={class:"documents-content"},Lt={class:"tabs"},Jt=["onClick"],Kt={class:"label label-default"},Gt={class:"tab-content"},Ht={class:""},Qt=a(()=>e("i",{class:"picto icon-doc"},null,-1)),Yt=a(()=>e("small",{class:"text-light"},"  (Document généré automatiquement) ",-1)),Zt={class:"text-right show-over"},$t=["href"],es=a(()=>e("i",{class:"icon-upload-outline"},null,-1)),ts={class:"tab-content"},ss={key:0,class:"text-right"},ns=["onClick"],ls=a(()=>e("i",{class:"icon-download"},null,-1));function os(s,l,c,h,t,d){const _=P("date-picker"),g=P("person-auto-completer"),V=P("document-list");return i(),o(f,null,[t.error?(i(),o("div",L,[e("div",J,[e("h2",null,[m(" Erreur documents "),e("span",{class:"overlay-closer",onClick:l[0]||(l[0]=n=>t.error=null)},"X")]),e("p",K,[G,m(r(t.error),1)]),e("button",{class:"btn btn-default",onClick:l[1]||(l[1]=n=>t.error=null)},[H,m(" Fermer ")])])])):p("",!0),t.processDetails?(i(),o("div",Q,[e("div",Y,[e("h2",null,[Z,m(),$,e("strong",null,r(t.processDetails.label),1),m(),ee,e("span",te,[m(r(t.processDetails.status_text)+" - ",1),e("em",null,"étape "+r(t.processDetails.current_step)+" / "+r(t.processDetails.total_steps),1)]),e("span",{class:"overlay-closer",onClick:l[2]||(l[2]=(...n)=>d.handlerProcessDetailsOff&&d.handlerProcessDetailsOff(...n))},"X")]),(i(!0),o(f,null,D(t.processDetails.steps,n=>(i(),o("section",{class:v(["signature","signature-status-"+n.status])},[e("h4",null,[e("small",null,"étape "+r(n.order)+" : ",1),e("strong",null,r(n.label),1),e("span",se," ("+r(n.status_text)+")",1)]),e("ul",ne,[e("li",le,[m("Parapheur "),e("strong",null,r(n.letterfile),1)]),e("li",oe,[m("Niveau "),e("strong",null,r(n.level),1)])]),(i(!0),o(f,null,D(n.recipients,u=>(i(),o("article",{class:v(["recipient","signature-status-"+u.status])},[e("strong",ie,r(u.fullname),1),e("em",re,r(u.email),1),e("small",null,r(s.$filters.dateFull(u.dateFinished)),1),e("span",ce,[e("span",de,r(u.status_text),1)])],2))),256)),ae,(i(!0),o(f,null,D(n.observers,u=>(i(),o("span",null,[e("small",null,r(u.firstname),1),m(),e("span",null,r(u.lastname),1)]))),256))],2))),256)),e("div",ue,[e("button",{class:"btn btn-default",onClick:l[3]||(l[3]=(...n)=>d.handlerProcessDetailsOff&&d.handlerProcessDetailsOff(...n))},[me,m(" Fermer ")])])])])):p("",!0),e("section",he,[t.deleteData?(i(),o("div",pe,[e("div",_e,[e("h2",null,[m(" Suppression du fichier ? "),e("span",{class:"overlay-closer",onClick:l[4]||(l[4]=n=>t.deleteData=null)},"X")]),e("p",fe,[De,m(" Souhaitez-vous supprimer le fichier "),e("strong",null,r(t.deleteData.fileName),1),m(" ? ")]),e("button",{class:"btn btn-danger",onClick:l[5]||(l[5]=n=>t.deleteData=null)},[be,m(" Annuler ")]),e("a",{class:"btn btn-success",href:t.deleteData.urlDelete},[ge,m(" Confirmer ")],8,ve)])])):p("",!0),t.editedDocument?(i(),o("div",ye,[e("div",ke,[e("h2",null,[e("small",null,[Se,t.mode=="new"?(i(),o("span",we,"Téléversement d'un document")):p("",!0),t.mode=="edit"?(i(),o("span",Pe,"Modification des informations")):p("",!0),t.mode=="version"?(i(),o("span",Ce,"Nouvelle version")):p("",!0)]),Te,t.editedDocument.id>0?(i(),o("span",Ie,[e("strong",null,r(t.editedDocument.fileName),1)])):(i(),o("span",xe,[m(" Nouveau document dans "),e("strong",null,r(t.editedDocument.tabDocument.label),1)])),e("span",null," ("+r(t.mode)+") ",1),e("span",{class:"overlay-closer",onClick:l[6]||(l[6]=n=>t.editedDocument=null)},"X")]),e("div",Fe,[e("div",Ne,[t.mode!="edit"?(i(),o("div",Ve,[Ee,e("input",{onChange:l[7]||(l[7]=(...n)=>d.uploadFile&&d.uploadFile(...n)),type:"file",class:"form-control",name:"file",id:"file"},null,32)])):p("",!0),e("div",null,[Ue,k(_,{modelValue:t.editedDocument.dateDeposit,"onUpdate:modelValue":l[8]||(l[8]=n=>t.editedDocument.dateDeposit=n),id:"dateDeposit"},null,8,["modelValue"])]),e("div",null,[Oe,k(_,{modelValue:t.editedDocument.dateSend,"onUpdate:modelValue":l[9]||(l[9]=n=>t.editedDocument.dateSend=n),id:"dateSend"},null,8,["modelValue"])])]),e("div",Me,[t.mode!="version"?(i(),o("div",Re,[We,e("div",null,[b(e("select",{name:"tabdocument",id:"tabdocument","onUpdate:modelValue":l[10]||(l[10]=n=>t.editedDocument.tabDocument.id=n),class:"form-control"},[(i(!0),o(f,null,D(t.tabsWithDocuments,(n,u)=>(i(),o("option",{value:u,key:u},r(n.label),9,Ae))),128))],512),[[C,t.editedDocument.tabDocument.id]])])])):p("",!0),t.mode!="version"?(i(),o("div",ze,[qe,t.editedDocument.process?(i(),o("div",je," Vous ne pouvez pas modifier le type d'un document engagé dans un processus de signature. ")):(i(),o("div",Be,[b(e("select",{class:"form-control",name:"type",id:"typedocument","onUpdate:modelValue":l[11]||(l[11]=n=>t.editedDocument.category.id=n)},[(i(!0),o(f,null,D(t.typesDocuments,(n,u)=>(i(),o("option",{value:n.id,key:n.id,disabled:n.flow&&t.editedDocument.id>0},r(n.label)+" "+r(n.flow&&t.editedDocument.id?"(signature)":""),9,Xe))),128))],512),[[C,t.editedDocument.category.id]])]))])):p("",!0)]),e("div",Le,[Je,b(e("textarea",{"onUpdate:modelValue":l[12]||(l[12]=n=>t.editedDocument.information=n),id:"information",class:"form-control"},null,512),[[U,t.editedDocument.information]])]),t.mode=="change"?(i(),o("div",Ke,[e("div",Ge,[t.editedDocument.private===!1?(i(),o("span",He,[Qe,e("div",null,[b(e("select",{name:"tabdocument",id:"tabdocument","onUpdate:modelValue":l[13]||(l[13]=n=>t.editedDocument.tabDocument.id=n),class:"form-control"},[(i(!0),o(f,null,D(t.tabsWithDocuments,(n,u)=>(i(),o("option",{value:u,key:u},r(n.label),9,Ye))),128))],512),[[C,t.editedDocument.tabDocument.id]])])])):p("",!0),Ze,e("div",$e,[b(e("input",{type:"checkbox",name:"private",id:"privateModifDoc",class:"form-control","onUpdate:modelValue":l[14]||(l[14]=n=>t.editedDocument.private=n)},null,512),[[T,t.editedDocument.private]])])]),t.editedDocument.private===!0?(i(),o("span",et,[tt,st,k(g,{onChange:d.handlerSelectPersons},null,8,["onChange"]),(i(!0),o(f,null,D(t.editedDocument.persons,n=>(i(),o("span",{key:n.id,class:"cartouche"},[nt,e("span",null,r(n.personName),1),e("span",lt,r(n.affectation),1),n.personId!==t.idCurrentPerson?(i(),o("i",{key:0,onClick:u=>d.handlerDeletePerson(n),class:"icon-trash icon-clickable"},null,8,ot)):p("",!0)]))),128))])):p("",!0)])):p("",!0)]),e("div",it,[e("div",rt,[e("nav",ct,[e("button",{class:"btn btn-danger",onClick:l[15]||(l[15]=n=>t.editedDocument=null)},[dt,m(" Annuler ")]),e("a",{class:"btn btn-success",href:"#",onClick:l[16]||(l[16]=I(n=>d.applyEdit(),["prevent"]))},[at,m(" Enregistrer ")])])])])])])):p("",!0),t.signDocument?(i(),o("div",ut,[e("div",mt,[e("h2",null,[e("span",{class:"overlay-closer",onClick:l[17]||(l[17]=n=>t.signDocument=null)},"X")]),e("nav",null,[m(" Selectionnez un procédure de signature "),(i(!0),o(f,null,D(t.signProcess,n=>(i(),o("span",{class:v(["btn btn-lg btn-default",{"btn-success":t.selectedSignProcess&&t.selectedSignProcess.id==n.id}]),onClick:u=>d.handlerSelectProcess(n)},[e("strong",null,r(n.label),1),pt,e("em",null,r(n.description)+" ",1)],10,ht))),256))]),t.selectedSignProcess?(i(),o("section",_t,[e("h3",null,[ft,Dt,e("strong",null,r(t.selectedSignProcess.label),1)]),(i(!0),o(f,null,D(t.selectedSignProcess.steps,n=>(i(),o("article",{class:v(["step",n.missing_recipients?"error":"ok"])},[e("h4",null,[m("étape "+r(n.order)+" :",1),e("strong",null,r(n.label),1)]),e("ul",bt,[e("li",vt,[m("Parapheur: "),e("strong",null,r(n.letterfile_label),1)]),e("li",gt,[m("Type: "),e("strong",null,r(n.level_label),1)]),e("li",yt,[m("Tous signent: "),e("strong",null,r(n.allSignToComplete?"Oui":"non"),1)])]),n.missing_recipients?(i(),o("div",kt," Il manque des destinataires pour cette procédure. ")):p("",!0),e("div",St,[e("div",wt,[Pt,(i(!0),o(f,null,D(n.recipients,u=>(i(),o("div",Ct,[n.editable?b((i(),o("input",{key:0,type:"checkbox","onUpdate:modelValue":w=>u.selected=w},null,8,Tt)),[[T,u.selected]]):p("",!0),e("strong",It,r(u.email),1),e("span",xt,r(u.firstname)+" "+r(u.lastname),1)]))),256))]),e("div",Ft,[Nt,n.observers.length?(i(!0),o(f,{key:0},D(n.observers,u=>(i(),o("div",Vt,[n.editable?b((i(),o("input",{key:0,type:"checkbox","onUpdate:modelValue":w=>u.selected=w},null,8,Et)),[[T,u.selected]]):p("",!0),e("strong",Ut,r(u.email),1),e("span",Ot,r(u.firstname)+" "+r(u.lastname),1)]))),256)):(i(),o("div",Mt," Pas d'observateur pour cette étape "))])])],2))),256))])):p("",!0),t.signProcessError?(i(),o("div",Rt,[m(" Signature non-disponible : "),e("strong",null,r(t.signProcessError),1)])):p("",!0),e("nav",Wt,[e("button",{class:"btn btn-default",onClick:l[18]||(l[18]=n=>t.signDocument=null)},[At,m(" Annuler ")]),e("button",{class:v(["btn btn-success",{disabled:d.handlerPerformSignDocumentDisabled(t.signDocument,t.selectedSignProcess)}]),onClick:l[19]||(l[19]=n=>d.handlerPerformSignDocument(t.signDocument,t.selectedSignProcess))},[zt,m(" Valider ")],2)])])])):p("",!0),t.errorMessages.length!==0?(i(),o("div",qt,[e("div",jt,[e("h2",null,[e("span",{class:"overlay-closer",onClick:l[20]||(l[20]=n=>t.errorMessages=[])},"X")]),e("ul",null,[(i(!0),o(f,null,D(t.errorMessages,n=>(i(),o("li",null,r(n),1))),256))]),e("button",{class:"btn btn-danger",onClick:l[21]||(l[21]=n=>t.errorMessages=[])},[Bt,m(" Retour ")])])])):p("",!0),e("section",Xt,[e("div",Lt,[(i(!0),o(f,null,D(d.packedDocuments,n=>(i(),o("div",{class:v(["tab",{selected:t.selectedTabId===n.id}]),onClick:I(u=>d.handlerSelectTab(n),["prevent"])},[m(r(n.label)+" ",1),e("sup",Kt,r(n.total),1)],10,Jt))),256)),e("div",{class:v(["tab",{selected:t.displayComputed}]),onClick:l[22]||(l[22]=I(n=>d.handlerSelectTab("computed"),["prevent"]))}," Documents générés ",2)]),b(e("div",Gt,[(i(!0),o(f,null,D(t.computedDocuments,n=>(i(),o("article",{class:"card xs",key:n.key},[e("div",Ht,[Qt,e("strong",null,r(n.label),1),Yt]),e("nav",Zt,[e("a",{class:"btn btn-default btn-xs",href:n.url},[es,m(" Télécharger ")],8,$t)])]))),128))],512),[[F,t.displayComputed]]),(i(!0),o(f,null,D(d.packedDocuments,n=>b((i(),o("div",ts,[n.manage?(i(),o("nav",ss,[n.manage?(i(),o("button",{key:0,onClick:u=>d.handlerNew(n.id),class:"btn btn-xs btn-default"},[ls,m(" Téléverser un document ")],8,ns)):p("",!0)])):p("",!0),k(V,{documents:n.documents,tabs:t.tabsWithDocuments,types:t.typesDocuments,"sign-process":t.signProcess,"display-activity":!1,onFetch:d.fetch},null,8,["documents","tabs","types","sign-process","onFetch"])],512)),[[F,t.selectedTabId===n.id]])),256))])])],64)}const is=j(X,[["render",os],["__scopeId","data-v-517e3447"]]);let S=document.querySelector("#activitydocuments");const N=R(is,{url:S.dataset.url,urlUploadNewDoc:S.dataset.urlUploadNewDoc,urlSignDocument:S.dataset.urlSignDocument,manage:S.dataset.manage});N.config.globalProperties.$filters={timeAgo(s){return x.timeAgo(s)},date(s){return x.date(s)},dateFull(s){return x.dateFull(s)},filesize(s){return q.filesize(s)}};N.mount("#activitydocuments");
