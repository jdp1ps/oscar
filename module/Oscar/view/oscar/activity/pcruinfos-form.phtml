<?php
/**
 * @author Stéphane Bouvry<stephane.bouvry@unicaen.fr>
 * @date: 16/10/15 13:41
 * @copyright Certic (c) 2015
 */
?>
<link rel="stylesheet" type="text/css"
      href="<?= $this->basePath() . '/js/vendor/bootstrap-datepicker/dist/css/bootstrap-datepicker3.min.css' ?>" />
<div class="container">
    <h1>
        <?php if($activity->getProject()): ?>
            <small class="text-light">
                <i class="icon-cubes"></i>
                <?= $activity->getProject() ?>
            </small><br/>
        <?php endif; ?>
        <?php if( $activity->getId() ): ?>
            <strong><i class="icon-cube"></i> <?= $activity->getLabel() ?></strong> (Modification)
        <?php else: ?>
            <strong><i class="icon-cube"></i> <?= $this->translate("Nouvelle activité") ?></strong>
        <?php endif; ?>
    </h1>


    <div class="form">
        <h3>
            <i class="icon-info-circled"></i>
            <?= $this->translate("Informations") ?>
        </h3>
        <?= $this->form()->openTag($form->prepare()); ?>

        <table class="table table-bordered card xs">
            <thead>
            <tr>
                <th title="Numéro de colonne de le fichier d'export">N°</th>
                <th>Champ PCRU</th>
                <th>Géré</th>
                <th>Valide</th>
                <th>Valeur envoyée</th>
                <th>Informations</th>
            </tr>
            </thead>

            <tbody>
                <tr>
                    <th>1</th>
                    <td>Objet</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('objet'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('objet')); ?></td>
                    <td><?= $headers['Objet'] == 'off' ? 'Saisie manuelle' : $headers['Objet']  ?></td>
                </tr>

                <tr>
                    <th>2</th>
                    <td>CodeUniteLabintel</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('codeunitelabintel'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('codeunitelabintel')); ?></td>
                    <td><?= $headers['CodeUniteLabintel'] == 'off' ? 'Saisie manuelle' : $headers['CodeUniteLabintel']  ?></td>
                </tr>

                <tr>
                    <th>3</th>
                    <td>SigleUnite</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('sigleunite'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('sigleunite')); ?></td>
                    <td><?= $headers['SigleUnite'] == 'off' ? 'Saisie manuelle' : $headers['SigleUnite']  ?></td>
                </tr>

                <tr>
                    <th>4</th>
                    <td>NumContratTutelleGestionnaire</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('numcontrattutellegestionnaire'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('numcontrattutellegestionnaire')); ?></td>
                    <td><?= $headers['NumContratTutelleGestionnaire'] == 'off' ? 'Saisie manuelle' : $headers['NumContratTutelleGestionnaire']  ?></td>
                </tr>

                <tr>
                    <th>5</th>
                    <td>Equipe</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('equipe'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('equipe')); ?></td>
                    <td><?= $headers['Equipe'] == 'off' ? 'Saisie manuelle' : $headers['Equipe']  ?></td>
                </tr>

                <tr>
                    <th>6</th>
                    <td>TypeContrat</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('typecontrat'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formSelect($form->get('typecontrat')); ?></td>
                    <td><?= $headers['TypeContrat'] == 'off' ? 'Saisie manuelle' : $headers['TypeContrat']  ?></td>
                </tr>

                 <tr>
                    <th>7</th>
                    <td>Acronyme</td>
                    <td><i class="icon-ok-circled"></td>
                     <td><?= $this->formElementErrors($form->get('acronyme'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('acronyme')); ?></td>
                     <td><?= $headers['Acronyme'] == 'off' ? 'Saisie manuelle' : $headers['Acronyme']  ?></td>
                </tr>

                <tr>
                    <th>8</th>
                    <td>ContratsAssocies</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('contratsassocies'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('contratsassocies')); ?></td>
                    <td><?= $headers['ContratsAssocies'] == 'off' ? 'Saisie manuelle' : $headers['ContratsAssocies']  ?></td>
                </tr>
                <tr>
                    <th>9</th>
                    <td>ResponsableScientifique</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('responsablescientifique'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formSelect($form->get('responsablescientifique')); ?></td>
                    <td><?= $headers['ResponsableScientifique'] == 'off' ? 'Saisie manuelle' : $headers['ResponsableScientifique']  ?></td>
                </tr>
                <tr>
                    <th>10</th>
                    <td>EmployeurResponsableScientifique</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('employeurresponsablescientifique'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('employeurresponsablescientifique')); ?></td>
                    <td><?= $headers['EmployeurResponsableScientifique'] == 'off' ? 'Saisie manuelle' : $headers['EmployeurResponsableScientifique']  ?></td>
                </tr>


                <tr>
                    <th>11</th>
                    <td>CoordinateurConsortium</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('coordinateurconsortium'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formCheckbox($form->get('coordinateurconsortium')); ?></td>
                    <td>
                        <?= $headers['CoordinateurConsortium'] == 'off' ? 'Saisie manuelle' : $headers['CoordinateurConsortium']  ?>
                        Le Responsable scientifique est également le coordinateur du consortium
                    </td>
                </tr>

                <tr>
                    <th>12</th>
                    <td>Partenaires</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('partenaires'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('partenaires')); ?></td>
                    <td><?= $headers['Partenaires'] == 'off' ? 'Saisie manuelle' : $headers['Partenaires']  ?></td>
                </tr>
                <tr>
                    <th>13</th>
                    <td>PartenairePrincipal</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('partenaireprincipal'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formSelect($form->get('partenaireprincipal')); ?></td>
                    <td><?= $headers['PartenairePrincipal'] == 'off' ? 'Saisie manuelle' : $headers['PartenairePrincipal']  ?></td>
                </tr>
                <tr>
                    <th>14</th>
                    <td>IdPartenairePrincipal</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('idpartenaireprincipal'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('idpartenaireprincipal')); ?></td>
                    <td><?= $headers['IdPartenairePrincipal'] == 'off' ? 'Saisie manuelle' : $headers['IdPartenairePrincipal']  ?></td>
                </tr>
                <tr>
                    <th>15</th>
                    <td>SourceFinancement</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('sourcefinancement'), ['class' => 'alert alert-danger']); ?></td>
                    <td>
                        <?= $this->formSelect($form->get('sourcefinancement')); ?>
                    </td>
                    <td><?= $headers['SourceFinancement'] == 'off' ? 'Saisie manuelle' : $headers['SourceFinancement']  ?></td>
                </tr>
                <tr>
                    <th>16</th>
                    <td>LieuExecution</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('lieuexecution'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('lieuexecution')); ?></td>
                    <td><?= $headers['LieuExecution'] == 'off' ? 'Saisie manuelle' : $headers['LieuExecution']  ?></td>
                </tr>

                <tr>
                    <th>17</th>
                    <td>DateDerniereSignature</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('datedernieresignature'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('datedernieresignature')); ?></td>
                    <td><?= $headers['DateDerniereSignature'] == 'off' ? 'Saisie manuelle' : $headers['DateDerniereSignature']  ?></td>
                </tr>

                <tr>
                    <th>18</th>
                    <td>Duree</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('duree'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('duree')); ?></td>
                    <td><?= $headers['Duree'] == 'off' ? 'Saisie manuelle' : $headers['Duree']  ?></td>
                </tr>

                <tr>
                    <th>19</th>
                    <td>DateDebut</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('datedebut'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('datedebut')); ?></td>
                    <td><?= $headers['DateDebut'] == 'off' ? 'Saisie manuelle' : $headers['DateDebut']  ?></td>
                </tr>

                <tr>
                    <th>20</th>
                    <td>DateFin</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('datefin'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('datefin')); ?></td>
                    <td><?= $headers['DateFin'] == 'off' ? 'Saisie manuelle' : $headers['DateFin']  ?></td>
                </tr>

                <tr>
                    <th>21</th>
                    <td>MontantPercuUnite</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('montantpercuunite'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('montantpercuunite')); ?></td>
                    <td><?= $headers['MontantPercuUnite'] == 'off' ? 'Saisie manuelle' : $headers['MontantPercuUnite']  ?></td>
                </tr>

                <tr>
                    <th>22</th>
                    <td>CoutTotalEtude</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('couttotaletude'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('couttotaletude')); ?></td>
                    <td><?= $headers['CoutTotalEtude'] == 'off' ? 'Saisie manuelle' : $headers['CoutTotalEtude']  ?></td>
                </tr>

                <tr>
                    <th>23</th>
                    <td>MontantTotal</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('montanttotal'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('montanttotal')); ?></td>
                    <td><?= $headers['MontantTotal'] == 'off' ? 'Saisie manuelle' : $headers['MontantTotal']  ?></td>
                </tr>
                <tr>
                    <th>24</th>
                    <td>ValidePoleCompetivite</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('validepolecompetivite'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formCheckbox($form->get('validepolecompetivite')); ?></td>
                    <td><?= $headers['ValidePoleCompetivite'] == 'off' ? 'Saisie manuelle' : $headers['ValidePoleCompetivite']  ?></td>
                </tr>

                <tr>
                    <th>25</th>
                    <td>PoleCompetivite</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('polecompetivite'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formSelect($form->get('polecompetivite')); ?></td>
                    <td><?= $headers['PoleCompetivite'] == 'off' ? 'Saisie manuelle' : $headers['PoleCompetivite']  ?></td>
                </tr>

                <tr>
                    <th>26</th>
                    <td>Commentaires</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('commentaires'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formTextarea($form->get('commentaires')); ?></td>
                    <td><?= $headers['Commentaires'] == 'off' ? 'Saisie manuelle' : $headers['Commentaires']  ?></td>
                </tr>
                <tr>
                    <th>27</th>
                    <td>Pia</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('pia'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formCheckbox($form->get('pia')); ?></td>
                    <td><small>Est PIA ?</small></td>
                </tr>
                <tr>
                    <th>28</th>
                    <td>Reference</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('reference'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('reference')); ?></td>
                    <td><?= $headers['Reference'] == 'off' ? 'Saisie manuelle' : $headers['Reference']  ?></td>
                </tr>
                <tr>
                    <th>29</th>
                    <td>AccordCadre</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('accordcadre'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formCheckbox($form->get('accordcadre')); ?></td>
                    <td><?= $headers['AccordCadre'] == 'off' ? 'Saisie manuelle' : $headers['AccordCadre']  ?></td>
                </tr>

                <tr>
                    <th>30</th>
                    <td>Cifre</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('cifre'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formCheckbox($form->get('cifre')); ?></td>
                    <td><?= $headers['Cifre'] == 'off' ? 'Saisie manuelle' : $headers['Cifre']  ?></td>
                </tr>
                <tr>
                    <th>31</th>
                    <td>ChaireIndustrielle</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('chaireindustrielle'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formInput($form->get('chaireindustrielle')); ?></td>
                    <td><?= $headers['ChaireIndustrielle'] == 'off' ? 'Saisie manuelle' : $headers['ChaireIndustrielle']  ?></td>
                </tr>
                <tr>
                    <th>32</th>
                    <td>PresencePartenaireIndustriel</td>
                    <td><i class="icon-ok-circled"></td>
                    <td><?= $this->formElementErrors($form->get('presencepartenaireindustriel'), ['class' => 'alert alert-danger']); ?></td>
                    <td><?= $this->formCheckbox($form->get('presencepartenaireindustriel')); ?></td>
                    <td><?= $headers['PresencePartenaireIndustriel'] == 'off' ? 'Saisie manuelle' : $headers['PresencePartenaireIndustriel']  ?></td>
                </tr>
            </tbody>

        </table>

        <nav class="buttons text-center">
            <a class="btn btn-default btn-lg" href="<?= $this->url('contract/pcru-infos', ['id' => $activity->getId() ]) ?>">
                Revenir
            </a>
            <button type="submit" class="btn btn-success btn-lg">
                <?php if( $mode == 'edit' ):?>
                <i class="icon-floppy"></i>
                Enregistrement
                <?php else: ?>
                <i class="icon-paper-plane"></i>
                Activer PCRU
                <?php endif; ?>
            </button>
        </nav>

        <?= $this->form()->closeTag() ?>
    </div>
    <hr>
</div>
<script>
    Initer.ready(function(){
        require(['select2'], function(){
            $('[name="activityType"], .select2').select2();
        });

        $('[name=partenaireprincipal]').on('change', function(e){
            var value = $(e.currentTarget).val();
            $('[name=idpartenaireprincipal]').val(value);
            console.log(value);
        })

        require(['Keyvalue'], function(KeyValue){
            console.log(KeyValue);
        });
    })
</script>
